[["index.html", "AlberdiLab | Manuscript in prep Dietary intervention in captive-bred hares fails to enrich gut microbiomes with wild-like functions Chapter 1 Introduction 1.1 Prepare the R environment", " AlberdiLab | Manuscript in prep Dietary intervention in captive-bred hares fails to enrich gut microbiomes with wild-like functions Blinded for review 2024-11-28 Chapter 1 Introduction 1.1 Prepare the R environment 1.1.1 Environment To reproduce all the analyses locally, clone this repository in your computer using: RStudio &gt; New Project &gt; Version Control &gt; Git And indicating the following git repository: [Blinded for review] Once the R project has been created, follow the instructions and code chunks shown in this webbook. 1.1.2 Libraries The following R packages are required for the data analysis. # Base library(R.utils) library(knitr) library(tidyverse) library(devtools) library(tinytable) library(rairtable) library(janitor) library(rmarkdown) # For tree handling library(ape) library(phyloseq) library(phytools) # For plotting library(ggplot2) library(ggrepel) library(ggpubr) library(ggnewscale) library(gridExtra) library(ggtreeExtra) library(ggtree) library(ggh4x) # For statistics library(spaa) library(vegan) library(Rtsne) library(geiger) library(hilldiv2) library(distillR) library(broom.mixed) #library(lmerTest) library(Hmsc) library(corrplot) library(lme4) library(nlme) library(ANCOMBC) "],["prepare-data.html", "Chapter 2 Prepare data 2.1 Load data 2.2 Create working objects 2.3 Prepare color scheme 2.4 Prepare a phyloseq object 2.5 Wrap working objects", " Chapter 2 Prepare data 2.1 Load data Load the original data files outputted by the bioinformatic pipeline. 2.1.1 Sample metadata sample_metadata &lt;- read_tsv(&quot;data/DMB0165_metadata.tsv&quot;) %&gt;% rename(sample=1) 2.1.2 Read counts read_counts &lt;- read_tsv(&quot;data/DMB0165_counts.tsv.gz&quot;) %&gt;% rename(genome=1) %&gt;% select(one_of(c(&quot;genome&quot;,sample_metadata$sample))) 2.1.3 Genome taxonomy genome_metadata &lt;- read_tsv(&quot;data/DMB0165_mag_info.tsv.gz&quot;) %&gt;% rename(length=mag_size)%&gt;% semi_join(., read_counts, by = &quot;genome&quot;) %&gt;% arrange(match(genome,read_counts$genome)) 2.1.4 Genome base hits genome_coverage &lt;- read_tsv(&quot;data/DMB0165_coverage.tsv.gz&quot;) %&gt;% rename(genome=1) %&gt;% select(one_of(c(&quot;genome&quot;,sample_metadata$sample)))%&gt;% semi_join(., genome_metadata, by = &quot;genome&quot;)%&gt;% arrange(match(genome, read_counts$genome)) 2.1.5 Genome tree genome_tree &lt;- read_tree(&quot;data/DMB0165.tree.gz&quot;) genome_tree$tip.label &lt;- str_replace_all(genome_tree$tip.label,&quot;&#39;&quot;, &quot;&quot;) #remove single quotes in MAG names genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) # keep only MAG tips 2.1.6 Genome annotations Downloading individual annotation files from ERDA using information in Airtable and writing them to a single compressed table takes a while. The following chunk only needs to be run once, to generate the genome_annotations table that is saved in the data directory. Note that the airtable connection requires a personal access token. airtable(&quot;MAGs&quot;, &quot;appWbHBNLE6iAsMRV&quot;) %&gt;% #get base ID from Airtable browser URL read_airtable(., fields = c(&quot;ID&quot;,&quot;mag_name&quot;,&quot;number_genes&quot;,&quot;anno_url&quot;), id_to_col = TRUE) %&gt;% #get 3 columns from MAGs table filter(mag_name %in% paste0(genome_metadata$genome,&quot;.fa&quot;)) %&gt;% #filter by MAG name filter(number_genes &gt; 0) %&gt;% #genes need to exist select(anno_url) %&gt;% #list MAG annotation urls pull() %&gt;% read_tsv() %&gt;% #load all tables rename(gene=1, genome=2, contig=3) %&gt;% #rename first 3 columns write_tsv(file=&quot;data/genome_annotations.tsv.xz&quot;) #write to overall compressed file genome_annotations &lt;- read_tsv(&quot;data/genome_annotations.tsv.xz&quot;) %&gt;% rename(gene=1, genome=2, contig=3) 2.2 Create working objects Transform the original data files into working objects for downstream analyses. 2.2.1 Filter reads by coverage min_coverage=0.3 read_counts_filt &lt;- genome_coverage %&gt;% mutate(across(where(is.numeric), ~ ifelse(. &gt; min_coverage, 1, 0))) %&gt;% mutate(across(-1, ~ . * read_counts[[cur_column()]])) 2.2.2 Transform reads into genome counts readlength=150 genome_counts &lt;- read_counts %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) readlength=150 genome_counts_filt &lt;- read_counts_filt %&gt;% mutate(across(where(is.numeric), ~ . / (genome_metadata$length / readlength) )) 2.2.3 Distill annotations into GIFTs genome_gifts_raw &lt;- distill(genome_annotations,GIFT_db,genomecol=2,annotcol=c(9,10,19), verbosity=F) 2.3 Prepare color scheme AlberdiLab projects use unified color schemes developed for the Earth Hologenome Initiative, to facilitate figure interpretation. phylum_colors &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% arrange(match(genome, genome_tree$tip.label)) %&gt;% select(phylum, colors) %&gt;% unique() %&gt;% arrange(phylum) %&gt;% pull(colors, name=phylum) diet_colors&lt;- c(&quot;#F4B02E&quot;,&quot;#E6771D&quot;, &quot;#74C8AE&quot;) 2.4 Prepare a phyloseq object phylo_samples &lt;- sample_metadata %&gt;% column_to_rownames(&quot;sample&quot;) %&gt;% sample_data() #convert to phyloseq sample_data object phylo_genome &lt;- genome_counts_filt %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% otu_table(., taxa_are_rows = TRUE) phylo_taxonomy &lt;- genome_metadata %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% as.matrix() %&gt;% tax_table() #convert to phyloseq tax_table object phylo_tree &lt;- phy_tree(genome_tree) physeq_genome &lt;- phyloseq(phylo_genome, phylo_taxonomy, phylo_samples,phylo_tree) physeq_genome_clr &lt;- microbiome::transform(physeq_genome, &#39;clr&#39;) 2.5 Wrap working objects All working objects are wrapped into a single Rdata object to facilitate downstream usage. save(sample_metadata, genome_metadata, read_counts, genome_counts, genome_counts_filt, genome_tree, physeq_genome, physeq_genome_clr, genome_gifts_raw, phylum_colors, diet_colors, file = &quot;data/data.Rdata&quot;) "],["data-statistics.html", "Chapter 3 Data statistics 3.1 filter samples with high host data 3.2 Sequencing reads statistics 3.3 DNA fractions 3.4 Recovered microbial fraction", " Chapter 3 Data statistics load(&quot;data/data.Rdata&quot;) 3.1 filter samples with high host data sample_metadata &lt;- sample_metadata%&gt;% filter(!sample %in% c(&quot;EHI02721&quot;, &quot;EHI02712&quot;, &quot;EHI02700&quot;, &quot;EHI02720&quot;, &quot;EHI02749&quot;, &quot;EHI02719&quot;, &quot;EHI02729&quot;, &quot;EHI02715&quot;, &quot;EHI02722&quot;)) read_counts &lt;- read_counts %&gt;% select(one_of(c(&quot;genome&quot;,sample_metadata$sample)))%&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) genome_metadata &lt;- genome_metadata %&gt;% semi_join(., read_counts, by = &quot;genome&quot;) %&gt;% arrange(match(genome,read_counts$genome)) genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) # keep only MAG tips #load(&quot;data/genome_gifts.Rdata&quot;) 3.2 Sequencing reads statistics sample_metadata %&gt;% summarise(Total=sum(reads_post_fastp * 150 / 1000000000) %&gt;% round(2), mean=mean(reads_post_fastp * 150 / 1000000000) %&gt;% round(2), sd=sd(reads_post_fastp * 150 / 1000000000) %&gt;% round(2)) %&gt;% unite(&quot;Average&quot;,mean, sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% tt() .table td.tinytable_css_id73p28c5jfekfz795732c, .table th.tinytable_css_id73p28c5jfekfz795732c { border-bottom: solid 0.1em #d3d8dc; } Total Average 222.06 4.93 ± 1.08 3.3 DNA fractions sequence_fractions &lt;- read_counts %&gt;% pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;value&quot;) %&gt;% group_by(sample) %&gt;% summarise(mags = sum(value)) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% select(sample,mags,metagenomic_bases,host_bases,bases_lost_fastp_percent) %&gt;% mutate(mags_bases = mags*146) %&gt;% mutate(lowqual_bases = ((metagenomic_bases+host_bases)/(1-bases_lost_fastp_percent))-(metagenomic_bases+host_bases)) %&gt;% mutate(unmapped_bases = metagenomic_bases - mags_bases) %&gt;% mutate(unmapped_bases = ifelse(unmapped_bases &lt; 0, 0, unmapped_bases)) %&gt;% select(sample, lowqual_bases, host_bases, unmapped_bases, mags_bases) sequence_fractions %&gt;% mutate_at(vars(-sample), ~./1000000000) %&gt;% rename(&quot;Sample&quot;=1, &quot;Low quality&quot;=2, &quot;Mapped to host&quot;=3, &quot;Unmapped&quot;=4, &quot;Mapped to MAGs&quot;=5) %&gt;% tt() .table td.tinytable_css_ido3myty9pabsjdn3q5f18, .table th.tinytable_css_ido3myty9pabsjdn3q5f18 { border-bottom: solid 0.1em #d3d8dc; } Sample Low quality Mapped to host Unmapped Mapped to MAGs EHI01861 0.2815721 0.011886522 1.2899665 2.94492935 EHI01963 0.2379339 0.377956197 0.7686364 2.26737109 EHI01964 0.3498799 2.739970327 0.5635412 1.32056898 EHI01965 0.3583169 0.398887483 1.3439432 3.82431144 EHI01969 0.2444974 0.026139904 0.7635264 2.53338864 EHI01971 0.3382550 0.014993899 1.0255034 3.94601821 EHI01972 0.4703327 0.054667824 1.3684974 5.49040300 EHI01973 0.3347793 0.064729480 1.5130592 4.84065102 EHI01974 0.3671355 0.052747090 0.8921925 2.95848005 EHI01975 0.4305111 0.123580711 1.9003492 5.31791948 EHI01976 0.3856202 0.011574334 1.2666400 3.26276449 EHI01977 0.4158680 0.747098387 1.7867623 3.87494103 EHI01978 0.3929906 0.004864216 1.2394723 3.63470402 EHI01980 0.3711274 0.013798033 1.7409090 5.56779249 EHI01981 0.3633649 0.020488667 1.2293197 3.03525532 EHI01983 0.2418940 0.146776195 0.8284920 2.84914941 EHI01984 0.4431283 0.007477209 1.2629388 5.76052943 EHI01986 0.3104557 0.016788774 0.9597449 3.38641569 EHI01987 0.4292930 0.001120181 0.9160842 3.32218036 EHI01988 0.2963428 0.197271999 1.0599471 3.92577283 EHI01990 0.3186345 0.010910854 1.0992821 3.87615385 EHI01991 0.3161992 0.021159611 1.1871737 2.82147205 EHI01993 0.2026808 0.006054774 0.5074436 2.59915566 EHI01994 0.3359364 0.064796021 0.9475828 3.88007790 EHI02699 0.2717760 0.007940738 1.1803471 3.05661322 EHI02700 0.3187046 3.815365599 0.7469281 0.43060671 EHI02701 0.2059134 0.135887208 0.9201707 2.92496093 EHI02705 0.2326028 0.134644975 1.0103929 3.05008177 EHI02707 0.2133975 0.197419011 1.0367591 2.56043485 EHI02708 0.3287951 0.247517459 1.4970876 3.72574889 EHI02710 0.2905179 0.004863423 1.1544139 3.25985646 EHI02712 0.3735243 4.162982418 0.5973263 0.12825939 EHI02714 0.2229262 0.166057029 0.7697399 3.24492767 EHI02715 0.3350685 3.050470506 0.9265001 0.43417816 EHI02718 0.2124597 1.622070570 0.4994065 1.33393017 EHI02719 0.3330425 2.607725990 1.8321792 0.33907536 EHI02720 0.3031357 3.089773324 0.7364466 0.19044999 EHI02721 0.3228625 3.677630914 0.6704712 0.08601152 EHI02722 0.3095520 2.799929187 0.7276464 0.41217450 EHI02723 0.2730593 0.113227422 0.9750562 3.21338043 EHI02724 0.3551211 0.121469083 0.9809314 3.69454095 EHI02728 0.3109121 1.043367740 0.9818139 2.94984474 EHI02729 0.3043389 2.024187975 1.5671125 0.47668212 EHI02749 0.4389880 4.177705067 0.7870159 0.53921786 EHI02751 0.4202354 3.712236730 0.7804933 1.77651793 sequence_fractions %&gt;% mutate_at(vars(-sample), ~./1000000000) %&gt;% rename(&quot;Sample&quot;=1, &quot;Low quality&quot;=2, &quot;Mapped to host&quot;=3, &quot;Unmapped&quot;=4, &quot;Mapped to MAGs&quot;=5) %&gt;% summarise(across(where(is.numeric), mean, na.rm = TRUE)) %&gt;% tt() Warning: There was 1 warning in `summarise()`. ℹ In argument: `across(where(is.numeric), mean, na.rm = TRUE)`. Caused by warning: ! The `...` argument of `across()` is deprecated as of dplyr 1.1.0. Supply arguments directly to `.fns` through an anonymous function instead. # Previously across(a:b, mean, na.rm = TRUE) # Now across(a:b, \\(x) mean(x, na.rm = TRUE)) .table td.tinytable_css_idmwzhepugztwvwsp20nq6, .table th.tinytable_css_idmwzhepugztwvwsp20nq6 { border-bottom: solid 0.1em #d3d8dc; } Low quality Mapped to host Unmapped Mapped to MAGs 0.3247485 0.9344047 1.063094 2.779287 sequence_fractions %&gt;% pivot_longer(!sample, names_to = &quot;fraction&quot;, values_to = &quot;value&quot;) %&gt;% mutate(value = value / 1000000000) %&gt;% mutate(fraction = factor(fraction, levels = c(&quot;lowqual_bases&quot;,&quot;host_bases&quot;,&quot;unmapped_bases&quot;,&quot;mags_bases&quot;))) %&gt;% ggplot(., aes(x = sample, y = value, fill=fraction)) + geom_bar(position=&quot;stack&quot;, stat = &quot;identity&quot;) + scale_fill_manual(name=&quot;Sequence type&quot;, breaks=c(&quot;lowqual_bases&quot;,&quot;host_bases&quot;,&quot;unmapped_bases&quot;,&quot;mags_bases&quot;), labels=c(&quot;Low quality&quot;,&quot;Mapped to host&quot;,&quot;Unmapped&quot;,&quot;Mapped to MAGs&quot;), values=c(&quot;#CCCCCC&quot;, &quot;#bcdee1&quot;, &quot;#d8b8a3&quot;,&quot;#93655c&quot;))+ labs(x = &quot;Samples&quot;, y = &quot;Amount of data (GB)&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size=6),legend.position = &quot;bottom&quot;) 3.4 Recovered microbial fraction singlem_table &lt;- sequence_fractions %&gt;% mutate(mags_proportion = round((mags_bases / (mags_bases + unmapped_bases))*100,2)) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% mutate(singlem_proportion = round(singlem_fraction,2)) %&gt;% select(sample,mags_proportion,singlem_proportion) %&gt;% mutate(mags_proportion = ifelse(singlem_proportion == 0, 0, mags_proportion)) %&gt;% #convert zeros to NA mutate(singlem_proportion = ifelse(singlem_proportion == 0, NA, singlem_proportion)) %&gt;% #convert zeros to NA mutate(singlem_proportion = ifelse(singlem_proportion &lt; mags_proportion, NA, singlem_proportion)) %&gt;% #if singlem is smaller, then NA, to simplify plot mutate(singlem_proportion = ifelse(singlem_proportion &gt; 100, 100, singlem_proportion)) #simplify singlem_table %&gt;% pivot_longer(!sample, names_to = &quot;proportion&quot;, values_to = &quot;value&quot;) %&gt;% mutate(proportion = factor(proportion, levels = c(&quot;mags_proportion&quot;,&quot;singlem_proportion&quot;))) %&gt;% ggplot(., aes(x = value, y = sample, color=proportion)) + geom_line(aes(group = sample), color = &quot;#f8a538&quot;) + geom_point() + scale_color_manual(name=&quot;Proportion&quot;, breaks=c(&quot;mags_proportion&quot;,&quot;singlem_proportion&quot;), labels=c(&quot;Recovered&quot;,&quot;Estimated&quot;), values=c(&quot;#52e1e8&quot;, &quot;#876b53&quot;))+ theme_classic() + labs(y = &quot;Samples&quot;, x = &quot;Prokaryotic fraction (%)&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size=6),legend.position = &quot;right&quot;) damr &lt;- singlem_table %&gt;% mutate(damr=ifelse(is.na(singlem_proportion),100,mags_proportion/singlem_proportion*100)) %&gt;% select(sample,damr) damr %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% filter(diet==&quot;Wild&quot;)%&gt;% summarise(mean=mean(damr),sd=sd(damr)) %&gt;% tt() .table td.tinytable_css_id8uzbv8tmtrgafhbdx1zr, .table th.tinytable_css_id8uzbv8tmtrgafhbdx1zr { border-bottom: solid 0.1em #d3d8dc; } mean sd 71.22498 34.9342 damr %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% filter(region==&quot;Nafarroa&quot;)%&gt;% summarise(mean=mean(damr),sd=sd(damr)) %&gt;% tt() .table td.tinytable_css_idgb488yzg404011hkshwm, .table th.tinytable_css_idgb488yzg404011hkshwm { border-bottom: solid 0.1em #d3d8dc; } mean sd 100 0 damr %&gt;% tt() .table td.tinytable_css_id9rtmjkcc4p98cv1uq1ni, .table th.tinytable_css_id9rtmjkcc4p98cv1uq1ni { border-bottom: solid 0.1em #d3d8dc; } sample damr EHI01861 100.00000 EHI01963 100.00000 EHI01964 100.00000 EHI01965 100.00000 EHI01969 100.00000 EHI01971 100.00000 EHI01972 100.00000 EHI01973 100.00000 EHI01974 100.00000 EHI01975 100.00000 EHI01976 100.00000 EHI01977 100.00000 EHI01978 100.00000 EHI01980 100.00000 EHI01981 100.00000 EHI01983 100.00000 EHI01984 100.00000 EHI01986 100.00000 EHI01987 100.00000 EHI01988 100.00000 EHI01990 100.00000 EHI01991 100.00000 EHI01993 100.00000 EHI01994 100.00000 EHI02699 100.00000 EHI02700 45.95376 EHI02701 100.00000 EHI02705 100.00000 EHI02707 100.00000 EHI02708 100.00000 EHI02710 100.00000 EHI02712 24.41989 EHI02714 100.00000 EHI02715 40.58764 EHI02718 100.00000 EHI02719 20.44770 EHI02720 24.69655 EHI02721 15.61599 EHI02722 46.16956 EHI02723 100.00000 EHI02724 100.00000 EHI02728 100.00000 EHI02729 30.17208 EHI02749 47.66147 EHI02751 100.00000 damr %&gt;% filter(damr&gt;95) %&gt;% nrow() [1] 36 damr %&gt;% summarise(mean=mean(damr),sd=sd(damr)) %&gt;% tt() .table td.tinytable_css_idimk6u3lnilen5i8tesi9, .table th.tinytable_css_idimk6u3lnilen5i8tesi9 { border-bottom: solid 0.1em #d3d8dc; } mean sd 86.57166 27.6675 "],["mag-catalogue.html", "Chapter 4 MAG catalogue 4.1 filter samples with high host data 4.2 Genome phylogeny 4.3 Taxonomy overview 4.4 Mag size (MB) 4.5 Genome quality 4.6 Functional overview 4.7 Functional ordination", " Chapter 4 MAG catalogue load(&quot;data/data.Rdata&quot;) 4.1 filter samples with high host data sample_metadata &lt;- sample_metadata%&gt;% filter(!sample %in% c(&quot;EHI02721&quot;, &quot;EHI02712&quot;, &quot;EHI02700&quot;, &quot;EHI02720&quot;, &quot;EHI02749&quot;, &quot;EHI02719&quot;, &quot;EHI02729&quot;, &quot;EHI02715&quot;, &quot;EHI02722&quot;)) genome_counts_filt &lt;- genome_counts %&gt;% select(one_of(c(&quot;genome&quot;,sample_metadata$sample)))%&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) genome_metadata &lt;- genome_metadata %&gt;% semi_join(., genome_counts_filt, by = &quot;genome&quot;) %&gt;% arrange(match(genome,genome_counts_filt$genome)) genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) # keep only MAG tips #load(&quot;data/genome_gifts.Rdata&quot;) 4.2 Genome phylogeny # Generate the phylum color heatmap phylum_heatmap &lt;- read_tsv(&quot;https://raw.githubusercontent.com/earthhologenome/EHI_taxonomy_colour/main/ehi_phylum_colors.tsv&quot;) %&gt;% right_join(genome_metadata, by=join_by(phylum == phylum)) %&gt;% arrange(match(genome, genome_tree$tip.label)) %&gt;% select(genome,phylum) %&gt;% mutate(phylum = factor(phylum, levels = unique(phylum))) %&gt;% column_to_rownames(var = &quot;genome&quot;) # Generate new species table newspecies_table &lt;- genome_metadata %&gt;% mutate(newspecies=ifelse(species==&quot;s__&quot;,&quot;Y&quot;,&quot;N&quot;)) %&gt;% select(genome,newspecies) %&gt;% column_to_rownames(var = &quot;genome&quot;) # Generate wild table wild_heatmap &lt;- genome_counts_filt %&gt;% pivot_longer(!genome,names_to=&quot;sample&quot;,values_to=&quot;abundance&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(diet==&quot;Wild&quot;) %&gt;% group_by(genome) %&gt;% summarise(presence=ifelse(sum(abundance)&gt;0,&quot;present&quot;,&quot;absent&quot;)) %&gt;% column_to_rownames(var=&quot;genome&quot;) # Generate captive table captive_heatmap &lt;- genome_counts_filt %&gt;% pivot_longer(!genome,names_to=&quot;sample&quot;,values_to=&quot;abundance&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(diet==&quot;Pre_grass&quot;) %&gt;% group_by(genome) %&gt;% summarise(presence=ifelse(sum(abundance)&gt;0,&quot;present&quot;,&quot;absent&quot;)) %&gt;% column_to_rownames(var=&quot;genome&quot;) # Generate grass table grass_heatmap &lt;- genome_counts_filt %&gt;% pivot_longer(!genome,names_to=&quot;sample&quot;,values_to=&quot;abundance&quot;) %&gt;% left_join(sample_metadata,by=&quot;sample&quot;) %&gt;% filter(diet==&quot;Post_grass&quot;) %&gt;% group_by(genome) %&gt;% summarise(presence=ifelse(sum(abundance)&gt;0,&quot;present&quot;,&quot;absent&quot;)) %&gt;% column_to_rownames(var=&quot;genome&quot;) # Generate basal tree circular_tree &lt;- force.ultrametric(genome_tree, method=&quot;extend&quot;) %&gt;% # extend to ultrametric for the sake of visualisation ggtree(., layout=&quot;fan&quot;, open.angle=10, size=0.2) *************************************************************** * Note: * * force.ultrametric does not include a formal method to * * ultrametricize a tree &amp; should only be used to coerce * * a phylogeny that fails is.ultrametric due to rounding -- * * not as a substitute for formal rate-smoothing methods. * *************************************************************** # Add phylum ring circular_tree &lt;- gheatmap(circular_tree, phylum_heatmap, offset=0.05, width=0.05, colnames=FALSE) + scale_fill_manual(values=phylum_colors) + theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) # Flush color scale to enable a new color scheme in the next ring circular_tree &lt;- circular_tree + new_scale_fill() # Add completeness ring circular_tree &lt;- circular_tree + new_scale_fill() + scale_fill_gradient(low = &quot;#d1f4ba&quot;, high = &quot;#f4baba&quot;) + geom_fruit( data=genome_metadata, geom=geom_bar, mapping = aes(x=completeness, y=genome, fill=contamination), offset = 0.3, pwidth = 0.1, orientation=&quot;y&quot;, stat=&quot;identity&quot;) # Add genome-size ring circular_tree &lt;- circular_tree + new_scale_fill() circular_tree &lt;- gheatmap(circular_tree, wild_heatmap, offset=0.3, width=0.05, colnames=FALSE) + scale_fill_manual(values=c(&quot;#ffffff&quot;,&quot;#74C8AE&quot;)) + theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) + new_scale_fill() circular_tree &lt;- gheatmap(circular_tree, captive_heatmap, offset=0.4, width=0.05, colnames=FALSE) + scale_fill_manual(values=c(&quot;#ffffff&quot;,&quot;#F4B02E&quot;)) + theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) + new_scale_fill() circular_tree &lt;- gheatmap(circular_tree, grass_heatmap, offset=0.5, width=0.05, colnames=FALSE) + scale_fill_manual(values=c(&quot;#ffffff&quot;,&quot;#E6771D&quot;)) + theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) + new_scale_fill() circular_tree &lt;- gheatmap(circular_tree, newspecies_table, offset=1.2, width=0.05, colnames=FALSE) + scale_fill_manual(values=c(&quot;#f4f4f4&quot;,&quot;#666666&quot;)) theme(legend.position = &quot;none&quot;, plot.margin = margin(0, 0, 0, 0), panel.margin = margin(0, 0, 0, 0)) List of 3 $ legend.position: chr &quot;none&quot; $ plot.margin : &#39;margin&#39; num [1:4] 0points 0points 0points 0points ..- attr(*, &quot;unit&quot;)= int 8 $ panel.spacing : &#39;margin&#39; num [1:4] 0points 0points 0points 0points ..- attr(*, &quot;unit&quot;)= int 8 - attr(*, &quot;class&quot;)= chr [1:2] &quot;theme&quot; &quot;gg&quot; - attr(*, &quot;complete&quot;)= logi FALSE - attr(*, &quot;validate&quot;)= logi TRUE # Add text circular_tree &lt;- circular_tree + annotate(&#39;text&#39;, x=2.9, y=0, label=&#39; Phylum&#39;, family=&#39;arial&#39;, size=3.5) + annotate(&#39;text&#39;, x=3.3, y=0, label=&#39; Group&#39;, family=&#39;arial&#39;, size=3.5) + annotate(&#39;text&#39;, x=3.8, y=0, label=&#39; Genome quality&#39;, family=&#39;arial&#39;, size=3.5) + annotate(&#39;text&#39;, x=4.2, y=0, label=&#39; New species&#39;, family=&#39;arial&#39;, size=3.5) #Plot circular tree circular_tree %&gt;% open_tree(30) %&gt;% rotate_tree(90) 4.3 Taxonomy overview tax_mag &lt;-genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(mag_n=n()) tax_mag %&gt;% mutate(percetage_mag=round(mag_n*100/sum(mag_n), 2)) %&gt;% arrange(-percetage_mag) %&gt;% tt() .table td.tinytable_css_idat21ji6ahvqz68znfg4e, .table th.tinytable_css_idat21ji6ahvqz68znfg4e { border-bottom: solid 0.1em #d3d8dc; } phylum mag_n percetage_mag p__Bacillota_A 526 61.16 p__Bacteroidota 127 14.77 p__Bacillota 53 6.16 p__Pseudomonadota 39 4.53 p__Verrucomicrobiota 35 4.07 p__Synergistota 18 2.09 p__Actinomycetota 15 1.74 p__Patescibacteria 13 1.51 p__Desulfobacterota 12 1.40 p__Bacillota_C 9 1.05 p__Cyanobacteriota 7 0.81 p__Bacillota_B 2 0.23 p__Spirochaetota 2 0.23 p__Campylobacterota 1 0.12 p__Methanobacteriota 1 0.12 4.4 Mag size (MB) genome_metadata &lt;-genome_metadata %&gt;% mutate(corrected_size=100*length/completeness) Mags average size (MB) genome_metadata %&gt;% summarise(Average_corrected_size=mean(corrected_size)) %&gt;% tt() .table td.tinytable_css_idmivhvaceq1x0qage53pd, .table th.tinytable_css_idmivhvaceq1x0qage53pd { border-bottom: solid 0.1em #d3d8dc; } Average_corrected_size 2651482 Minimum Mags size (MB) genome_metadata %&gt;% filter(corrected_size==min(corrected_size)) %&gt;% tt() .table td.tinytable_css_idcdbh9h1oi4dyb2j5bne3, .table th.tinytable_css_idcdbh9h1oi4dyb2j5bne3 { border-bottom: solid 0.1em #d3d8dc; } genome domain phylum class order family genus species completeness contamination length corrected_size EHA03306_bin.234 d__Bacteria p__Patescibacteria c__Saccharimonadia o__Saccharimonadales f__Nanosyncoccaceae g__Nanosyncoccus s__ 52.57 7.13 326026 620175 Maximum Mags size (MB) genome_metadata %&gt;% filter(corrected_size==max(corrected_size)) %&gt;% tt() .table td.tinytable_css_id68yhpizjju65yx5xziat, .table th.tinytable_css_id68yhpizjju65yx5xziat { border-bottom: solid 0.1em #d3d8dc; } genome domain phylum class order family genus species completeness contamination length corrected_size EHA04588_bin.47 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Lawsonibacter s__ 56.31 5.39 5576430 9903090 Mags arrange by size (MB) genome_metadata %&gt;% arrange(corrected_size) %&gt;% paged_table() Mags average size and completeness by phylum genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(average_size=mean(corrected_size),sd_size=sd(corrected_size),average_comp=mean(completeness),sd_comp=sd(completeness)) %&gt;% mutate(Size=str_c(round(average_size,2),&quot;±&quot;,round(sd_size,2)), Completeness=str_c(round(average_comp,2),&quot;±&quot;,round(sd_comp,2))) %&gt;% arrange(-average_size) %&gt;% select(phylum, Size, Completeness) %&gt;% tt() .table td.tinytable_css_idgwenzuvatz81727grodj, .table th.tinytable_css_idgwenzuvatz81727grodj { border-bottom: solid 0.1em #d3d8dc; } phylum Size Completeness p__Bacteroidota 4150649.86±1672281.53 76.62±17.72 p__Pseudomonadota 2604751.8±835336.03 82.68±17.96 p__Verrucomicrobiota 2538115.51±808033.83 81.21±14.05 p__Bacillota_A 2534693.22±882541.15 81.5±16.81 p__Desulfobacterota 2207699.48±163896.46 85.49±13.65 p__Synergistota 2141226.18±176298.47 75.8±16.94 p__Spirochaetota 2053326.59±36521.71 94.71±0.12 p__Actinomycetota 1998831.26±620954.65 76.63±18.44 p__Bacillota_B 1932803.47±73181.05 90±2.28 p__Cyanobacteriota 1877859.37±192085.35 92.95±17.85 p__Methanobacteriota NA NA p__Bacillota_C 1638316.23±205183.8 90.94±16.02 p__Bacillota 1551655.29±517109.39 83.87±12.72 p__Campylobacterota NA NA p__Patescibacteria 1042754.15±629671.65 77.42±17.81 Mags average size and completeness by phylum in wild wild_data &lt;-sample_metadata %&gt;% filter(diet==&quot;Wild&quot;) wild_genome &lt;- genome_counts %&gt;% select(genome, all_of(wild_data$sample)) %&gt;% filter(rowSums(across(where(is.numeric)))!=0) wild_genome_metadata &lt;- genome_metadata %&gt;% filter(genome %in% wild_genome$genome) %&gt;% arrange(match(genome,wild_genome$genome)) wild_genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(average_size=mean(corrected_size),sd_size=sd(corrected_size),average_comp=mean(completeness),sd_comp=sd(completeness)) %&gt;% mutate(Size=str_c(round(average_size,2),&quot;±&quot;,round(sd_size,2)), Completeness=str_c(round(average_comp,2),&quot;±&quot;,round(sd_comp,2))) %&gt;% arrange(-average_size) %&gt;% select(phylum, Size, Completeness) %&gt;% tt() .table td.tinytable_css_idede4bv7t47yvd96za039, .table th.tinytable_css_idede4bv7t47yvd96za039 { border-bottom: solid 0.1em #d3d8dc; } phylum Size Completeness p__Bacteroidota 4150649.86±1672281.53 76.62±17.72 p__Pseudomonadota 2616167.41±843460.54 83.21±17.89 p__Verrucomicrobiota 2538115.51±808033.83 81.21±14.05 p__Bacillota_A 2537653.23±880765.5 81.48±16.82 p__Desulfobacterota 2207699.48±163896.46 85.49±13.65 p__Synergistota 2141226.18±176298.47 75.8±16.94 p__Spirochaetota 2053326.59±36521.71 94.71±0.12 p__Actinomycetota 1998831.26±620954.65 76.63±18.44 p__Bacillota_B 1932803.47±73181.05 90±2.28 p__Cyanobacteriota 1877859.37±192085.35 92.95±17.85 p__Bacillota_C 1638316.23±205183.8 90.94±16.02 p__Bacillota 1551655.29±517109.39 83.87±12.72 p__Campylobacterota NA NA p__Patescibacteria 1042754.15±629671.65 77.42±17.81 wild_genome_metadata %&gt;% summarise(average_size=mean(corrected_size),sd_size=sd(corrected_size),average_comp=mean(completeness),sd_comp=sd(completeness)) %&gt;% mutate(Size=str_c(round(average_size,2),&quot;±&quot;,round(sd_size,2)), Completeness=str_c(round(average_comp,2),&quot;±&quot;,round(sd_comp,2))) %&gt;% arrange(-average_size) %&gt;% select(-Size, -Completeness) %&gt;% tt() .table td.tinytable_css_idsbpr7d9gonvaoswv8v6t, .table th.tinytable_css_idsbpr7d9gonvaoswv8v6t { border-bottom: solid 0.1em #d3d8dc; } average_size sd_size average_comp sd_comp 2655093 1210519 80.9823 16.79731 Mags average size and completeness by phylum in captivity pre_data &lt;-sample_metadata %&gt;% filter(diet==&quot;Pre_grass&quot;) pre_genome &lt;- genome_counts %&gt;% select(genome, all_of(pre_data$sample)) %&gt;% filter(rowSums(across(where(is.numeric)))!=0) pre_genome_metadata &lt;- genome_metadata %&gt;% filter(genome %in% pre_genome$genome) %&gt;% arrange(match(genome,pre_genome$genome)) pre_genome_metadata %&gt;% group_by(phylum) %&gt;% summarise(average_size=mean(corrected_size),sd_size=sd(corrected_size),average_comp=mean(completeness),sd_comp=sd(completeness)) %&gt;% mutate(Size=str_c(round(average_size,2),&quot;±&quot;,round(sd_size,2)), Completeness=str_c(round(average_comp,2),&quot;±&quot;,round(sd_comp,2))) %&gt;% arrange(-average_size) %&gt;% select(phylum, Size, Completeness) %&gt;% tt() .table td.tinytable_css_idgt0m97th56ruodlvpr0t, .table th.tinytable_css_idgt0m97th56ruodlvpr0t { border-bottom: solid 0.1em #d3d8dc; } phylum Size Completeness p__Bacteroidota 4150649.86±1672281.53 76.62±17.72 p__Pseudomonadota 2605452.27±846537.48 82.87±18.16 p__Verrucomicrobiota 2538115.51±808033.83 81.21±14.05 p__Bacillota_A 2534693.22±882541.15 81.5±16.81 p__Desulfobacterota 2207699.48±163896.46 85.49±13.65 p__Synergistota 2141226.18±176298.47 75.8±16.94 p__Spirochaetota 2053326.59±36521.71 94.71±0.12 p__Actinomycetota 1998831.26±620954.65 76.63±18.44 p__Bacillota_B 1932803.47±73181.05 90±2.28 p__Cyanobacteriota 1877859.37±192085.35 92.95±17.85 p__Methanobacteriota NA NA p__Bacillota_C 1638316.23±205183.8 90.94±16.02 p__Bacillota 1551655.29±517109.39 83.87±12.72 p__Campylobacterota NA NA p__Patescibacteria 1048485.03±657316.38 76.17±17.99 pre_genome_metadata %&gt;% summarise(average_size=mean(corrected_size),sd_size=sd(corrected_size),average_comp=mean(completeness),sd_comp=sd(completeness)) %&gt;% mutate(Size=str_c(round(average_size,2),&quot;±&quot;,round(sd_size,2)), Completeness=str_c(round(average_comp,2),&quot;±&quot;,round(sd_comp,2))) %&gt;% arrange(-average_size) %&gt;% select(-Size, -Completeness) # A tibble: 1 × 4 average_size sd_size average_comp sd_comp &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 2653523. 1210343. 81.0 16.8 4.5 Genome quality genome_metadata %&gt;% summarise(completeness_mean=mean(completeness) %&gt;% round(2) %&gt;% as.character(), completeness_sd=sd(completeness) %&gt;% round(2) %&gt;% as.character(), contamination_mean=mean(contamination) %&gt;% round(2), contamination_sd=sd(contamination) %&gt;% round(2)) %&gt;% unite(&quot;Completeness&quot;,completeness_mean, completeness_sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% unite(&quot;Contamination&quot;,contamination_mean, contamination_sd, sep = &quot; ± &quot;, remove = TRUE) %&gt;% tt() .table td.tinytable_css_idnxy7mvf864rrfruulepd, .table th.tinytable_css_idnxy7mvf864rrfruulepd { border-bottom: solid 0.1em #d3d8dc; } Completeness Contamination 80.99 ± 16.79 2.21 ± 2.32 #Generate quality biplot genome_biplot &lt;- genome_metadata %&gt;% select(c(genome,domain,phylum,completeness,contamination,length)) %&gt;% arrange(match(genome, rev(genome_tree$tip.label))) %&gt;% #sort MAGs according to phylogenetic tree ggplot(aes(x=completeness,y=contamination,size=length,color=phylum)) + geom_point(alpha=0.7) + ylim(c(10,0)) + scale_color_manual(values=phylum_colors) + labs(y= &quot;Contamination&quot;, x = &quot;Completeness&quot;) + theme_classic() + theme(legend.position = &quot;none&quot;) #Generate contamination boxplot genome_contamination &lt;- genome_metadata %&gt;% ggplot(aes(y=contamination)) + ylim(c(10,0)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0.40, 0),&quot;inches&quot;)) #add bottom-margin (top, right, bottom, left) #Generate completeness boxplot genome_completeness &lt;- genome_metadata %&gt;% ggplot(aes(x=completeness)) + xlim(c(50,100)) + geom_boxplot(colour = &quot;#999999&quot;, fill=&quot;#cccccc&quot;) + theme_void() + theme(legend.position = &quot;none&quot;, axis.title.x = element_blank(), axis.title.y = element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(), plot.margin = unit(c(0, 0, 0, 0.50),&quot;inches&quot;)) #add left-margin (top, right, bottom, left) #Render composite figure grid.arrange(grobs = list(genome_completeness,genome_biplot,genome_contamination), layout_matrix = rbind(c(1,1,1,1,1,1,1,1,1,1,1,4), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3), c(2,2,2,2,2,2,2,2,2,2,2,3))) 4.6 Functional overview genome_annotations &lt;- read_tsv(&quot;data/genome_annotations.tsv.xz&quot;) %&gt;% rename(gene=1, genome=2, contig=3) # Predicted genes genome_annotations %&gt;% nrow() [1] 1362707 # Some annotation genome_annotations %&gt;% filter(if_any(c(kegg_id, pfam_hits, cazy_hits), ~ !is.na(.))) %&gt;% nrow() [1] 1045555 # KEGG annotation genome_annotations %&gt;% filter(!is.na(kegg_id)) %&gt;% nrow() [1] 610762 # Aggregate basal GIFT into elements genome_gifts&lt;-genome_gifts_raw function_table &lt;- genome_gifts %&gt;% to.elements(., GIFT_db) # Generate basal tree function_tree &lt;- force.ultrametric(genome_tree, method=&quot;extend&quot;) %&gt;% ggtree(., size = 0.3) *************************************************************** * Note: * * force.ultrametric does not include a formal method to * * ultrametricize a tree &amp; should only be used to coerce * * a phylogeny that fails is.ultrametric due to rounding -- * * not as a substitute for formal rate-smoothing methods. * *************************************************************** #Add phylum colors next to the tree tips function_tree &lt;- gheatmap(function_tree, phylum_heatmap, offset=0, width=0.1, colnames=FALSE) + scale_fill_manual(values=phylum_colors) + labs(fill=&quot;Phylum&quot;) #Reset fill scale to use a different colour profile in the heatmap function_tree &lt;- function_tree + new_scale_fill() #Add functions heatmap function_tree &lt;- gheatmap(function_tree, function_table, offset=0.5, width=3.5, colnames=FALSE) + vexpand(.08) + coord_cartesian(clip = &quot;off&quot;) + scale_fill_gradient(low = &quot;#f4f4f4&quot;, high = &quot;steelblue&quot;, na.value=&quot;white&quot;) + labs(fill=&quot;GIFT&quot;) #Reset fill scale to use a different colour profile in the heatmap function_tree &lt;- function_tree + new_scale_fill() # Add completeness barplots function_tree &lt;- function_tree + geom_fruit(data=genome_metadata, geom=geom_bar, grid.params=list(axis=&quot;x&quot;, text.size=2, nbreak = 1), axis.params=list(vline=TRUE), mapping = aes(x=length, y=genome, fill=completeness), offset = 3.8, orientation=&quot;y&quot;, stat=&quot;identity&quot;) + scale_fill_gradient(low = &quot;#cf8888&quot;, high = &quot;#a2cc87&quot;) + labs(fill=&quot;Genome\\ncompleteness&quot;) function_tree 4.7 Functional ordination # Generate the tSNE ordination tSNE_function &lt;- Rtsne(X=function_table, dims = 2, check_duplicates = FALSE) # Plot the ordination function_ordination &lt;- tSNE_function$Y %&gt;% as.data.frame() %&gt;% mutate(genome=rownames(function_table)) %&gt;% inner_join(genome_metadata, by=&quot;genome&quot;) %&gt;% rename(tSNE1=&quot;V1&quot;, tSNE2=&quot;V2&quot;) %&gt;% select(genome,phylum,tSNE1,tSNE2, length) %&gt;% ggplot(aes(x = tSNE1, y = tSNE2, color = phylum, size=length))+ geom_point(shape=16, alpha=0.7) + scale_color_manual(values=phylum_colors) + theme_minimal() + labs(color=&quot;Phylum&quot;, size=&quot;Genome size&quot;) + guides(color = guide_legend(override.aes = list(size = 5))) # enlarge Phylum dots in legend function_ordination "],["community-composition.html", "Chapter 5 Community composition 5.1 Filter data 5.2 Load data 5.3 Taxonomy overview 5.4 Taxonomy boxplot", " Chapter 5 Community composition 5.1 Filter data load(&quot;data/data.Rdata&quot;) Filter samples with high host data sample_metadata &lt;- sample_metadata %&gt;% filter(!sample %in% c(&quot;EHI02721&quot;, &quot;EHI02712&quot;, &quot;EHI02700&quot;, &quot;EHI02720&quot;, &quot;EHI02749&quot;, &quot;EHI02719&quot;, &quot;EHI02729&quot;, &quot;EHI02715&quot;, &quot;EHI02722&quot;)) genome_counts_filt &lt;- genome_counts %&gt;% select(one_of(c(&quot;genome&quot;,sample_metadata$sample)))%&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) genome_counts &lt;- genome_counts_filt genome_metadata &lt;- genome_metadata %&gt;% semi_join(., genome_counts_filt, by = &quot;genome&quot;) %&gt;% arrange(match(genome,genome_counts_filt$genome)) genome_tree &lt;- keep.tip(genome_tree, tip=genome_metadata$genome) # keep only MAG tips #load(&quot;data/genome_gifts.Rdata&quot;) Make a phyloseq object phylo_samples &lt;- sample_metadata %&gt;% column_to_rownames(&quot;sample&quot;) %&gt;% sample_data() #convert to phyloseq sample_data object phylo_genome &lt;- genome_counts_filt %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% otu_table(., taxa_are_rows = TRUE) phylo_taxonomy &lt;- genome_metadata %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% as.matrix() %&gt;% tax_table() #convert to phyloseq tax_table object phylo_tree &lt;- phy_tree(genome_tree) physeq_genome &lt;- phyloseq(phylo_genome, phylo_taxonomy, phylo_samples,phylo_tree) physeq_genome_clr &lt;- microbiome::transform(physeq_genome, &#39;clr&#39;) save(sample_metadata, genome_metadata, read_counts, genome_counts, genome_counts_filt, genome_tree, physeq_genome, physeq_genome_clr, genome_gifts_raw, # genome_gifts, phylum_colors, diet_colors, file = &quot;data/data_host_filtered.Rdata&quot;) 5.2 Load data load(&quot;data/data_host_filtered.Rdata&quot;) 5.3 Taxonomy overview 5.3.1 Stacked barplot genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS normalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(., genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata filter(count &gt; 0) %&gt;% #filter 0 counts ggplot(., aes(x=sample,y=count, fill=phylum, group=phylum)) + #grouping enables keeping the same sorting of taxonomic units geom_bar(stat=&quot;identity&quot;, colour=&quot;white&quot;, linewidth=0.1) + #plot stacked bars with white borders scale_fill_manual(values=phylum_colors) + facet_grid(~ diet, scale=&quot;free&quot;, space = &quot;free&quot;)+ # facet_nested(. ~ region+diet, scales=&quot;free&quot;) + #facet per day and treatment guides(fill = guide_legend(ncol = 1)) + theme( axis.title.x = element_blank(), panel.background = element_blank(), panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), strip.background = element_rect(fill = &quot;white&quot;), strip.text = element_text(size = 12, lineheight = 0.6), strip.placement = &quot;outside&quot;, axis.text.x = element_blank(), axis.ticks.x = element_blank(), axis.line = element_line(linewidth = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;)) + labs(fill=&quot;Phylum&quot;,y = &quot;Relative abundance&quot;,x=&quot;Samples&quot;) Number of bacteria phyla [1] 14 Bacteria phyla in wild individuals [1] 14 Bacteria phyla captive animals [1] 14 Bacteria phyla before grass is included in the diet [1] 14 Bacteria phyla after grass is included in the diet [1] 14 Number of Archaea phyla [1] 1 Archaea phyla in wild individuals [1] 0 Archaea phyla before grass is included in the diet [1] &quot;p__Methanobacteriota&quot; Archaea phyla after grass is included in the diet [1] &quot;p__Methanobacteriota&quot; 5.3.2 Genus and species annotation Number of MAGs without species-level annotation [1] 749 .table td.tinytable_css_idgee3urczebabk91eggj4, .table th.tinytable_css_idgee3urczebabk91eggj4 { border-bottom: solid 0.1em #d3d8dc; } phylum count_nospecies count_total percentage p__Actinomycetota 15 15 100.00000 p__Bacillota 52 53 98.11321 p__Bacillota_A 516 526 98.09886 p__Bacillota_B 2 2 100.00000 p__Bacillota_C 6 9 66.66667 p__Bacteroidota 43 127 33.85827 p__Campylobacterota 1 1 100.00000 p__Cyanobacteriota 6 7 85.71429 p__Desulfobacterota 12 12 100.00000 p__Patescibacteria 13 13 100.00000 p__Pseudomonadota 32 39 82.05128 p__Spirochaetota 2 2 100.00000 p__Synergistota 18 18 100.00000 p__Verrucomicrobiota 31 35 88.57143 Percentage of MAGs without species-level annotation [1] 87.09302 Number of MAGs without genera-level annotation 79 5.3.3 Phylum relative abundances phylum_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% left_join(genome_metadata, by = join_by(genome == genome)) %&gt;% group_by(sample,phylum,region, diet) %&gt;% summarise(relabun=sum(count)) phylum_arrange &lt;- phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(mean=mean(relabun)) %&gt;% arrange(-mean) %&gt;% select(phylum) %&gt;% pull() phylum_summary %&gt;% filter(phylum %in% phylum_arrange) %&gt;% mutate(phylum=factor(phylum,levels=rev(phylum_arrange))) %&gt;% ggplot(aes(x=relabun, y=phylum, group=phylum, color=phylum)) + scale_color_manual(values=phylum_colors[rev(phylum_arrange)]) + geom_jitter(alpha=0.5) + theme_minimal() + theme(legend.position=&quot;none&quot;) + labs(y=&quot;Phylum&quot;,x=&quot;Relative abundance&quot;) 5.3.3.1 Origin: Wild vs Captive phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), Wild_mean=mean(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Wild_sd=sd(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Captive_mean=mean(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Captive_sd=sd(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,3),&quot;±&quot;,round(total_sd,3)), Wild=str_c(round(Wild_mean,3),&quot;±&quot;,round(Wild_sd,3)), Captive=str_c(round(Captive_mean,3),&quot;±&quot;,round(Captive_sd,3))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(phylum,total,Wild,Captive) # A tibble: 15 × 4 phylum total Wild Captive &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 p__Bacillota_A 57.243±12.618 48.636±13.52 59.846±10.725 2 p__Bacteroidota 25.787±10.113 26.889±11.805 24.986±10.083 3 p__Bacillota 4.118±7.202 5.066±11.152 4.949±5.297 4 p__Spirochaetota 3.911±10.011 11.731±14.792 0.001±0.001 5 p__Verrucomicrobiota 2.264±5.722 1.472±0.715 1.449±1.295 6 p__Pseudomonadota 1.626±3.328 0.511±0.397 3.082±5.382 7 p__Patescibacteria 0.987±1.542 0.212±0.253 2.177±2.223 8 p__Synergistota 0.96±0.852 1.865±0.83 0.45±0.39 9 p__Bacillota_C 0.844±0.795 1.696±0.674 0.386±0.36 10 p__Actinomycetota 0.78±0.985 0.427±0.459 1.217±1.147 11 p__Cyanobacteriota 0.708±2.081 0.277±0.614 0.916±3.024 12 p__Desulfobacterota 0.586±0.396 0.991±0.315 0.41±0.256 13 p__Bacillota_B 0.104±0.145 0.228±0.203 0.042±0.024 14 p__Methanobacteriota 0.082±0.217 0±0 0.09±0.228 15 p__Campylobacterota 0±0 0±0 0±0 5.3.3.2 Origin and diet phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), Wild_mean=mean(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Wild_sd=sd(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Pre_grass_mean=mean(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Pre_grass_sd=sd(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Post_grass_mean=mean(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T), Post_grass_sd=sd(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T)) %&gt;% mutate(total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), Wild=str_c(round(Wild_mean,2),&quot;±&quot;,round(Wild_sd,2)), Pre_grass=str_c(round(Pre_grass_mean,6),&quot;±&quot;,round(Pre_grass_sd,6)), Post_grass=str_c(round(Post_grass_mean,2),&quot;±&quot;,round(Post_grass_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(phylum,total,Wild,Pre_grass,Post_grass) # A tibble: 15 × 5 phylum total Wild Pre_grass Post_grass &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 p__Bacillota_A 57.24±12.62 48.64±13.52 59.845932±10.725422 63.25±9.01 2 p__Bacteroidota 25.79±10.11 26.89±11.81 24.986055±10.082621 25.49±9.07 3 p__Bacillota 4.12±7.2 5.07±11.15 4.94862±5.296738 2.34±2.73 4 p__Spirochaetota 3.91±10.01 11.73±14.79 0.00063±0.000727 0±0 5 p__Verrucomicrobiota 2.26±5.72 1.47±0.71 1.448674±1.294628 3.87±9.89 6 p__Pseudomonadota 1.63±3.33 0.51±0.4 3.082488±5.382343 1.29±1.52 7 p__Patescibacteria 0.99±1.54 0.21±0.25 2.176993±2.223404 0.57±0.41 8 p__Synergistota 0.96±0.85 1.86±0.83 0.449802±0.390105 0.57±0.35 9 p__Bacillota_C 0.84±0.79 1.7±0.67 0.385614±0.359883 0.45±0.49 10 p__Actinomycetota 0.78±0.99 0.43±0.46 1.217389±1.147372 0.7±1.1 11 p__Cyanobacteriota 0.71±2.08 0.28±0.61 0.915635±3.024426 0.93±1.99 12 p__Desulfobacterota 0.59±0.4 0.99±0.31 0.410146±0.255958 0.36±0.25 13 p__Bacillota_B 0.1±0.15 0.23±0.2 0.041532±0.023962 0.04±0.02 14 p__Methanobacteriota 0.08±0.22 0±0 0.090366±0.227643 0.15±0.29 15 p__Campylobacterota 0±0 0±0 0.000127±0.000226 0±0 phylum_arrange &lt;- phylum_summary %&gt;% group_by(phylum) %&gt;% summarise(mean=sum(relabun)) %&gt;% arrange(-mean) %&gt;% select(phylum) %&gt;% pull() phylum_summary %&gt;% left_join(genome_metadata %&gt;% select(phylum,phylum) %&gt;% unique(),by=join_by(phylum==phylum)) %&gt;% # left_join(sample_metadata,by=join_by(sample==sample)) %&gt;% filter(phylum %in% phylum_arrange[1:20]) %&gt;% mutate(phylum=factor(phylum,levels=rev(phylum_arrange[1:20]))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=phylum, group=phylum, color=phylum)) + scale_color_manual(values=phylum_colors[-8]) + geom_jitter(alpha=0.5) + facet_grid(.~diet)+ theme_minimal() + labs(y=&quot;phylum&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.4 Taxonomy boxplot 5.4.1 Family family_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata left_join(., genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata group_by(sample,family, diet,region) %&gt;% summarise(relabun=sum(count)) family_summary$diet &lt;- factor(family_summary$diet, levels=c(&quot;Pre_grass&quot;, &quot;Post_grass&quot;, &quot;Wild&quot;)) 5.4.1.1 Origin: Wild vs Captive family_summary %&gt;% group_by(family) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), Wild_mean=mean(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Wild_sd=sd(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Cap_mean=mean(relabun[region==&quot;Nafarroa&quot;]*100, na.rm=T), Cap_sd=sd(relabun[region==&quot;Nafarroa&quot;]*100, na.rm=T)) %&gt;% mutate(Total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), Wild=str_c(round(Wild_mean,2),&quot;±&quot;,round(Wild_sd,2)), Captive=str_c(round(Cap_mean,2),&quot;±&quot;,round(Cap_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(family,Total,Wild,Captive) %&gt;% paged_table() 5.4.1.2 Origin and Diet family_summary %&gt;% group_by(family) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), Wild_mean=mean(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Wild_sd=sd(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Pre_grass_mean=mean(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Pre_grass_sd=sd(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Post_grass_mean=mean(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T), Post_grass_sd=sd(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T)) %&gt;% mutate(Total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), Wild=str_c(round(Wild_mean,2),&quot;±&quot;,round(Wild_sd,2)), Pre_grass=str_c(round(Pre_grass_mean,2),&quot;±&quot;,round(Pre_grass_sd,2)), Post_grass=str_c(round(Post_grass_mean,2),&quot;±&quot;,round(Post_grass_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(family,Total,Wild,Pre_grass,Post_grass) %&gt;% paged_table() family_arrange &lt;- family_summary %&gt;% group_by(family) %&gt;% summarise(mean=sum(relabun)) %&gt;% arrange(-mean) %&gt;% select(family) %&gt;% pull() family_summary %&gt;% left_join(genome_metadata %&gt;% select(family,phylum) %&gt;% unique(),by=join_by(family==family)) %&gt;% filter(family %in% family_arrange[1:20]) %&gt;% mutate(family=factor(family,levels=rev(family_arrange[1:20]))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=family, group=family, color=phylum)) + scale_color_manual(values=phylum_colors[-8]) + geom_jitter(alpha=0.5) + facet_grid(.~diet)+ theme_minimal() + labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) 5.4.2 Genus genus_summary &lt;- genome_counts_filt %&gt;% mutate_at(vars(-genome),~./sum(.)) %&gt;% #apply TSS nornalisation pivot_longer(-genome, names_to = &quot;sample&quot;, values_to = &quot;count&quot;) %&gt;% #reduce to minimum number of columns left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% #append sample metadata left_join(genome_metadata, by = join_by(genome == genome)) %&gt;% #append genome metadata group_by(sample,phylum,genus, diet) %&gt;% summarise(relabun=sum(count)) %&gt;% filter(genus != &quot;g__&quot;) %&gt;% mutate(genus= sub(&quot;^g__&quot;, &quot;&quot;, genus)) genus_summary$diet &lt;- factor(genus_summary$diet, levels=c(&quot;Pre_grass&quot;, &quot;Post_grass&quot;, &quot;Wild&quot;)) 5.4.3 origin and diet genus_summary %&gt;% group_by(genus) %&gt;% summarise(total_mean=mean(relabun*100, na.rm=T), total_sd=sd(relabun*100, na.rm=T), Wild_mean=mean(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Wild_sd=sd(relabun[diet==&quot;Wild&quot;]*100, na.rm=T), Pre_grass_mean=mean(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Pre_grass_sd=sd(relabun[diet==&quot;Pre_grass&quot;]*100, na.rm=T), Post_grass_mean=mean(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T), Post_grass_sd=sd(relabun[diet==&quot;Post_grass&quot;]*100, na.rm=T)) %&gt;% mutate(Total=str_c(round(total_mean,2),&quot;±&quot;,round(total_sd,2)), Wild=str_c(round(Wild_mean,2),&quot;±&quot;,round(Wild_sd,2)), Pre_grass=str_c(round(Pre_grass_mean,2),&quot;±&quot;,round(Pre_grass_sd,2)), Post_grass=str_c(round(Post_grass_mean,2),&quot;±&quot;,round(Post_grass_sd,2))) %&gt;% arrange(-total_mean) %&gt;% dplyr::select(genus,Total,Wild,Pre_grass,Post_grass) %&gt;% paged_table() genus_arrange &lt;- genus_summary %&gt;% group_by(genus) %&gt;% summarise(mean=sum(relabun)) %&gt;% filter(genus != &quot;g__&quot;)%&gt;% arrange(-mean) %&gt;% select(genus) %&gt;% mutate(genus= sub(&quot;^g__&quot;, &quot;&quot;, genus)) %&gt;% pull() genus_summary_sort &lt;- genus_summary %&gt;% group_by(genus) %&gt;% summarise(mean=mean(relabun, na.rm=T),sd=sd(relabun, na.rm=T)) %&gt;% arrange(-mean) genus_summary %&gt;% mutate(genus=factor(genus, levels=rev(genus_summary_sort %&gt;% pull(genus)))) %&gt;% filter(relabun &gt; 0) %&gt;% ggplot(aes(x=relabun, y=genus, group=genus, color=phylum)) + scale_color_manual(values=phylum_colors) + geom_jitter(alpha=0.5) + facet_grid(.~diet)+ theme_minimal() + theme(axis.text.y = element_text(size=6))+ labs(y=&quot;Family&quot;, x=&quot;Relative abundance&quot;, color=&quot;Phylum&quot;) "],["alpha-diversity.html", "Chapter 6 Alpha diversity 6.1 Summary table 6.2 Wild vs Captive-bred (pre-grass) 6.3 Captive-bred: pre-grass vs post-grass", " Chapter 6 Alpha diversity load(&quot;data/data_host_filtered.Rdata&quot;) 6.1 Summary table # Calculate Hill numbers richness &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 0) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(richness = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) neutral &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(neutral = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) phylogenetic &lt;- genome_counts_filt %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1, tree = genome_tree) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(phylogenetic = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) # # Aggregate basal GIFT into elements genome_counts_filt &lt;- genome_counts_filt[genome_counts_filt$genome %in% rownames(genome_gifts_raw),] genome_counts_filt &lt;- genome_counts_filt %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0))%&gt;% rownames_to_column(., &quot;genome&quot;) genome_gifts &lt;- genome_gifts_raw[rownames(genome_gifts_raw) %in% genome_counts_filt$genome,] genome_gifts &lt;- genome_gifts[, colSums(genome_gifts != 0) &gt; 0] dist &lt;- genome_gifts %&gt;% to.elements(., GIFT_db) %&gt;% traits2dist(., method = &quot;gower&quot;) functional &lt;- genome_counts_filt %&gt;% filter(genome %in% rownames(dist)) %&gt;% column_to_rownames(var = &quot;genome&quot;) %&gt;% dplyr::select(where(~ !all(. == 0))) %&gt;% hilldiv(., q = 1, dist = dist) %&gt;% t() %&gt;% as.data.frame() %&gt;% dplyr::rename(functional = 1) %&gt;% rownames_to_column(var = &quot;sample&quot;) %&gt;% mutate(functional = if_else(is.nan(functional), 1, functional)) # Merge all metrics alpha_div &lt;- richness %&gt;% full_join(neutral, by = join_by(sample == sample)) %&gt;% full_join(phylogenetic, by = join_by(sample == sample))%&gt;% full_join(functional, by = join_by(sample == sample)) .table td.tinytable_css_id57nhegcf78gzrj7u39us, .table th.tinytable_css_id57nhegcf78gzrj7u39us { border-bottom: solid 0.1em #d3d8dc; } alpha Wild Pre_grass Post_grass richness 795.67±26.45 836.83±16.57 835.67±14.03 neutral 70.62±37.82 112.37±28.26 101.87±41.5 phylogenetic 6.5±1.01 7.61±1.83 6.63±0.86 functional 1.45±0.04 1.53±0.05 1.51±0.03 6.2 Wild vs Captive-bred (pre-grass) 6.2.1 Shapiro test alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;richness&quot;) %&gt;% summarize(shapiro_p_value = shapiro.test(value)$p.value) %&gt;% pull(shapiro_p_value) [1] 0.00896346 alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;neutral&quot;) %&gt;% summarize(shapiro_p_value = shapiro.test(value)$p.value) %&gt;% pull(shapiro_p_value) [1] 0.03469882 alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;phylogenetic&quot;) %&gt;% summarize(shapiro_p_value = shapiro.test(value)$p.value) %&gt;% pull(shapiro_p_value) [1] 0.9219334 alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;phylogenetic&quot;) %&gt;% summarize(var.test_p_value_phylo = var.test(value ~ diet)$p.value) # A tibble: 1 × 1 var.test_p_value_phylo &lt;dbl&gt; 1 0.0600 alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;functional&quot;) %&gt;% summarize(shapiro_p_value = shapiro.test(value)$p.value) %&gt;% pull(shapiro_p_value) [1] 0.3997293 alpha_div %&gt;% pivot_longer(-sample, names_to = &quot;metric&quot;, values_to = &quot;value&quot;) %&gt;% left_join(., sample_metadata, by = join_by(sample == sample)) %&gt;% filter(!diet ==&quot;Post_grass&quot;) %&gt;% filter(metric==&quot;functional&quot;) %&gt;% summarize(var.test_p_functional = var.test(value ~ diet)$p.value) # A tibble: 1 × 1 var.test_p_functional &lt;dbl&gt; 1 0.859 6.2.2 Plots 6.3 Captive-bred: pre-grass vs post-grass 6.3.1 Plots 6.3.2 Mixed models Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;] Family: Negative Binomial(146764425) ( log ) Formula: richness ~ diet + (1 | individual) Data: alpha_div_meta AIC BIC logLik deviance df.resid 219.9 224.6 -105.9 211.9 20 Scaled residuals: Min 1Q Median 3Q Max -1.5499 -0.1527 0.1297 0.3168 0.6689 Random effects: Groups Name Variance Std.Dev. individual (Intercept) 4.059e-13 6.371e-07 Number of obs: 24, groups: individual, 12 Fixed effects: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) 6.729628 0.009843 683.7 &lt;2e-16 *** dietPost_grass -0.001400 0.013953 -0.1 0.92 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Correlation of Fixed Effects: (Intr) ditPst_grss -0.701 optimizer (Nelder_Mead) convergence code: 0 (OK) boundary (singular) fit: see help(&#39;isSingular&#39;) Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 232.4667 236.8308 -112.2333 Random effects: Formula: ~1 | individual (Intercept) Residual StdDev: 0.001716918 35.50333 Fixed effects: neutral ~ diet Value Std.Error DF t-value p-value (Intercept) 112.36648 10.24893 11 10.96373 0.000 dietPost_grass -10.49914 14.49417 11 -0.72437 0.484 Correlation: (Intr) dietPost_grass -0.707 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.0371846 -0.2957926 0.1194249 0.4747379 2.1136583 Number of Observations: 24 Number of Groups: 12 Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik 91.20606 95.57023 -41.60303 Random effects: Formula: ~1 | individual (Intercept) Residual StdDev: 0.0001476027 1.432123 Fixed effects: phylogenetic ~ diet Value Std.Error DF t-value p-value (Intercept) 7.614920 0.4134183 11 18.41941 0.0000 dietPost_grass -0.986097 0.5846618 11 -1.68661 0.1198 Correlation: (Intr) dietPost_grass -0.707 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -2.35109679 -0.47719193 -0.03827828 0.57082503 1.94927769 Number of Observations: 24 Number of Groups: 12 Linear mixed-effects model fit by REML Data: alpha_div_meta AIC BIC logLik -69.49624 -65.13207 38.74812 Random effects: Formula: ~1 | individual (Intercept) Residual StdDev: 1.631185e-06 0.03713605 Fixed effects: functional ~ diet Value Std.Error DF t-value p-value (Intercept) 1.5261340 0.01072026 11 142.3598 0.0000 dietPost_grass -0.0144785 0.01516073 11 -0.9550 0.3601 Correlation: (Intr) dietPost_grass -0.707 Standardized Within-Group Residuals: Min Q1 Med Q3 Max -1.5122885 -0.6779157 0.1131752 0.4439028 3.1416800 Number of Observations: 24 Number of Groups: 12 "],["beta-diversity.html", "Chapter 7 Beta diversity 7.1 Captive-bred vs wild 7.2 Before and after grass", " Chapter 7 Beta diversity load(&quot;data/data.Rdata&quot;) load(&quot;data/beta.Rdata&quot;) 7.1 Captive-bred vs wild load(&quot;data/beta_filtered_capwild.Rdata&quot;) load(&quot;data/data_host_filtered.Rdata&quot;) wild_pre_samples &lt;- sample_metadata %&gt;% filter(diet!=&quot;Post_grass&quot;) %&gt;% dplyr::select(sample) %&gt;% pull() genome_counts&lt;- genome_counts %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% select(all_of(wild_pre_samples))%&gt;% rownames_to_column(&quot;genome&quot;) sample_metadata &lt;- sample_metadata %&gt;% filter(diet!=&quot;Post_grass&quot;) beta_q0n &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 0) beta_q1n &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1) genome_counts &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0))%&gt;% rownames_to_column(., &quot;genome&quot;) genome_tree &lt;- keep.tip(genome_tree, tip=genome_counts$genome) beta_q1p &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, tree = genome_tree) genome_counts_filt &lt;- genome_counts[genome_counts$genome %in% rownames(genome_gifts),] genome_counts_filt &lt;- genome_counts_filt %&gt;% remove_rownames() %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0))%&gt;% rownames_to_column(., &quot;genome&quot;) genome_gifts1 &lt;- genome_gifts[rownames(genome_gifts) %in% genome_counts_filt$genome,] genome_gifts1 &lt;- genome_gifts1[, colSums(genome_gifts1 != 0) &gt; 0] dist &lt;- genome_gifts1 %&gt;% to.elements(., GIFT_db) %&gt;% traits2dist(., method = &quot;gower&quot;) beta_q1f &lt;- genome_counts_filt %&gt;% # remove_rownames() %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, dist = dist) 7.1.1 Permanova analysis set.seed(1234) Richness sample_metadata_row&lt;- column_to_rownames(sample_metadata, &quot;sample&quot;) sample_metadata_row &lt;- sample_metadata_row[labels(beta_q0n$S), ] betadisper(beta_q0n$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.004224 0.0042240 7.8055 999 0.003 ** Residuals 22 0.011905 0.0005412 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Wild Pre_grass 0.008 Wild 0.010583 adonis2(beta_q0n$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_idc7s4vph05acljyaz0i1g, .table th.tinytable_css_idc7s4vph05acljyaz0i1g { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.01526961 0.2489907 7.29391 0.001 Residual 22 0.04605641 0.7510093 NA NA Total 23 0.06132602 1.0000000 NA NA Neutral betadisper(beta_q1n$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.006925 0.0069254 0.5404 999 0.491 Residuals 22 0.281957 0.0128162 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Wild Pre_grass 0.476 Wild 0.47005 adonis2(beta_q1n$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_id1vnckno95z32cmot906w, .table th.tinytable_css_id1vnckno95z32cmot906w { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 1.538238 0.2539205 7.487472 0.001 Residual 22 4.519715 0.7460795 NA NA Total 23 6.057953 1.0000000 NA NA Phylogenetic betadisper(beta_q1p$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.007671 0.0076708 1.8217 999 0.179 Residuals 22 0.092637 0.0042108 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Wild Pre_grass 0.187 Wild 0.19084 adonis2(beta_q1p$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_iddmkp9k6batsrzu7eh6ku, .table th.tinytable_css_iddmkp9k6batsrzu7eh6ku { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.3720264 0.3082818 9.804858 0.001 Residual 22 0.8347476 0.6917182 NA NA Total 23 1.2067741 1.0000000 NA NA Functional betadisper(beta_q1f$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.003070 0.0030698 1.7361 999 0.171 Residuals 22 0.038901 0.0017682 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Wild Pre_grass 0.176 Wild 0.20119 adonis2(beta_q1f$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))), permutations = 999) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_id88lpswfn9kush5q5gddq, .table th.tinytable_css_id88lpswfn9kush5q5gddq { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.01079711 0.187686 5.083124 0.103 Residual 22 0.04673041 0.812314 NA NA Total 23 0.05752752 1.000000 NA NA 7.1.2 Beta diversity plots 7.1.2.1 Richness beta_q0n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = mean(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = mean(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Post_grass&quot; = &quot;Captive-bred grass diet&quot;, &quot;Wild&quot; = &quot;Wild&quot;))+ # stat_ellipse(aes(color = beta_q1n_nmds$Groups))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 12, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 12), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 12), legend.title = element_text(size = 14), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) +labs(color=&#39;Origin&#39;) 7.1.2.2 Neutral 7.1.2.3 Phylogenetic beta_q1p$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Wild&quot; = &quot;Wild&quot;))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Origin&#39;) 7.1.2.4 Functional beta_q1f$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Wild&quot; = &quot;Wild&quot;))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Origin&#39;) 7.2 Before and after grass load(&quot;data/beta_filtered_pre_post.Rdata&quot;) genome_counts &lt;- genome_counts_filt post_pre_samples &lt;- sample_metadata %&gt;% filter(diet!=&quot;Wild&quot;) %&gt;% dplyr::select(sample) %&gt;% pull() genome_counts&lt;- genome_counts %&gt;% column_to_rownames(&quot;genome&quot;) %&gt;% select(all_of(post_pre_samples))%&gt;% rownames_to_column(&quot;genome&quot;) sample_metadata &lt;- sample_metadata %&gt;% filter(diet!=&quot;Wild&quot;) beta_q0n &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 0) beta_q1n &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1) genome_counts &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0))%&gt;% rownames_to_column(., &quot;genome&quot;) genome_tree &lt;- keep.tip(genome_tree, tip=genome_counts$genome) beta_q1p &lt;- genome_counts %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, tree = genome_tree) genome_counts_filt &lt;- genome_counts[genome_counts$genome %in% rownames(genome_gifts),] genome_counts_filt &lt;- genome_counts_filt %&gt;% remove_rownames() %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0))%&gt;% rownames_to_column(., &quot;genome&quot;) genome_gifts1 &lt;- genome_gifts[rownames(genome_gifts) %in% genome_counts_filt$genome,] genome_gifts1 &lt;- genome_gifts1[, colSums(genome_gifts1 != 0) &gt; 0] dist &lt;- genome_gifts1 %&gt;% to.elements(., GIFT_db) %&gt;% traits2dist(., method = &quot;gower&quot;) beta_q1f &lt;- genome_counts_filt %&gt;% column_to_rownames(., &quot;genome&quot;) %&gt;% filter(rowSums(. != 0, na.rm = TRUE) &gt; 0) %&gt;% select_if(~!all(. == 0)) %&gt;% hillpair(., q = 1, dist = dist) 7.2.1 Permanova analysis set.seed(1234) Richness sample_metadata_row&lt;- column_to_rownames(sample_metadata, &quot;sample&quot;) sample_metadata_row &lt;- sample_metadata_row[labels(beta_q0n$S), ] betadisper(beta_q0n$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.0000047 0.00000467 0.0151 999 0.888 Residuals 22 0.0067978 0.00030899 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Post_grass Pre_grass 0.885 Post_grass 0.90328 adonis2(beta_q0n$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q0n$S))) %&gt;% pull(individual)) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_idtnof3c0bboex5czwuznl, .table th.tinytable_css_idtnof3c0bboex5czwuznl { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.0006002558 0.030093 0.6825872 0.785 Residual 22 0.0193464336 0.969907 NA NA Total 23 0.0199466894 1.000000 NA NA Neutral betadisper(beta_q1n$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.001983 0.0019829 0.1447 999 0.686 Residuals 22 0.301550 0.0137068 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Post_grass Pre_grass 0.686 Post_grass 0.70733 adonis2(beta_q1n$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1n$S))) %&gt;% pull(individual)) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_iduxw9ft7i2thnc6ve2tkc, .table th.tinytable_css_iduxw9ft7i2thnc6ve2tkc { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.147998 0.03074149 0.6977632 0.946 Residual 22 4.666278 0.96925851 NA NA Total 23 4.814276 1.00000000 NA NA Phylogenetic betadisper(beta_q1p$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.001772 0.0017715 0.4816 999 0.468 Residuals 22 0.080927 0.0036785 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Post_grass Pre_grass 0.465 Post_grass 0.49497 adonis2(beta_q1p$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1p$S))) %&gt;% pull(individual)) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_idv954y37hi4lt884c85bb, .table th.tinytable_css_idv954y37hi4lt884c85bb { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.02764442 0.04145548 0.951464 0.59 Residual 22 0.63920164 0.95854452 NA NA Total 23 0.66684606 1.00000000 NA NA Functional betadisper(beta_q1f$S, sample_metadata_row$diet) %&gt;% permutest(., pairwise = TRUE) Permutation test for homogeneity of multivariate dispersions Permutation: free Number of permutations: 999 Response: Distances Df Sum Sq Mean Sq F N.Perm Pr(&gt;F) Groups 1 0.008352 0.0083519 3.722 999 0.037 * Residuals 22 0.049367 0.0022439 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Pairwise comparisons: (Observed p-value below diagonal, permuted p-value above diagonal) Pre_grass Post_grass Pre_grass 0.03 Post_grass 0.066699 adonis2(beta_q1f$S ~ diet, data = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))), permutations = 999, strata = sample_metadata %&gt;% arrange(match(sample,labels(beta_q1f$S))) %&gt;% pull(individual)) %&gt;% broom::tidy() %&gt;% tt() .table td.tinytable_css_idxb0tsfo6ntz73zu8l0u2, .table th.tinytable_css_idxb0tsfo6ntz73zu8l0u2 { border-bottom: solid 0.1em #d3d8dc; } term df SumOfSqs R2 statistic p.value Model 1 0.002870065 0.03722968 0.8507252 0.452 Residual 22 0.074220722 0.96277032 NA NA Total 23 0.077090787 1.00000000 NA NA 7.2.2 Beta diversity plots 7.2.2.1 Richness beta_q0n$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Post_grass&quot; = &quot;Captive-bred grass diet&quot;))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Origin&#39;) 7.2.2.2 Neutral 7.2.2.3 Phylogenetic beta_q1p$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Post_grass&quot; = &quot;Captive-bred grass diet&quot;))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Origin&#39;) 7.2.2.4 Functional beta_q1f$S %&gt;% vegan::metaMDS(., trymax = 500, k = 2, trace=0) %&gt;% vegan::scores() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% dplyr::left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% group_by(diet) %&gt;% mutate(x_cen = median(NMDS1, na.rm = TRUE)) %&gt;% mutate(y_cen = median(NMDS2, na.rm = TRUE)) %&gt;% ungroup() %&gt;% ggplot(aes(x = NMDS1, y = NMDS2, color = diet)) + geom_point(size = 4) + scale_color_manual(values = diet_colors,labels=c(&quot;Pre_grass&quot; = &quot;Captive-bred no grass diet&quot;, &quot;Post_grass&quot; = &quot;Captive-bred grass diet&quot;))+ geom_segment(aes(x = x_cen, y = y_cen, xend = NMDS1, yend = NMDS2), alpha = 0.9, show.legend = FALSE) + theme_classic() + theme( axis.text.x = element_text(size = 12), axis.text.y = element_text(size = 12), axis.title = element_text(size = 20, face = &quot;bold&quot;), axis.text = element_text(face = &quot;bold&quot;, size = 18), panel.background = element_blank(), axis.line = element_line(size = 0.5, linetype = &quot;solid&quot;, colour = &quot;black&quot;), legend.text = element_text(size = 16), legend.title = element_text(size = 18), legend.position = &quot;right&quot;, legend.box = &quot;vertical&quot; ) + labs(color=&#39;Origin&#39;) "],["differential-abundance-analysis.html", "Chapter 8 Differential abundance analysis 8.1 Captive vs Wild 8.2 Captive: before and after grass 8.3 wild vs post grass captive", " Chapter 8 Differential abundance analysis 8.1 Captive vs Wild 8.1.1 Structural zeros # A tibble: 10 × 13 # Rowwise: genome present average domain phylum class order family genus species completeness contamination length &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 EHA03329_bin.40 pre 12.3 d__Bacteria p__Pseudomonadota c__Alphaproteobacteria o__RF… f__CA… g__ s__ 100 0.19 1.40e6 2 EHA03293_bin.11 pre 2.25 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Ca… f__Wo… g__I… s__ 94.5 0.68 2.30e6 3 EHA03293_bin.24 pre 1.66 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Bu… f__Bu… g__P… s__Pae… 100. 0.04 2.02e6 4 EHA03333_bin.4 pre 1.42 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Bu… f__Bu… g__O… s__ 94.4 1.56 2.05e6 5 EHA03306_bin.54 pre 1.27 d__Archaea p__Methanobacteriota c__Methanobacteria o__Me… f__Me… g__M… s__Met… 99.8 0.07 1.71e6 6 EHA03333_bin.7 pre 0.841 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Ca… f__Wo… g__I… s__ 62.0 1.36 1.93e6 7 EHA03294_bin.17 pre 0.755 d__Bacteria p__Bacillota_A c__Clostridia o__Ch… f__UB… g__C… s__ 88.3 1.19 8.66e5 8 EHA03333_bin.59 pre 0.627 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Ca… f__Wo… g__W… s__ 62.6 1.11 1.36e6 9 EHA04588_bin.94 wild 0.0000193 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Ca… f__Ca… g__ s__ 75.4 0.62 1.95e6 10 EHA04588_bin.140 &lt;NA&gt; NA d__Bacteria p__Patescibacteria c__JAEDAM01 o__BD… f__UB… g__G… s__ 92.4 0.18 9.00e5 8.1.2 Enrichment analysis: Ancombc2 8.1.2.1 MAG level 8.1.2.2 Genus level 8.1.2.3 Phylum level taxon lfc_dietWild p_dietWild 1 p__Spirochaetota 8.7284796 4.776516e-07 2 p__Bacillota_B 2.7666740 7.923227e-07 3 p__Synergistota 3.3563476 8.143247e-06 4 p__Bacillota_C 3.0796571 3.586172e-05 5 p__Desulfobacterota 2.3245267 5.530492e-05 6 p__Verrucomicrobiota 2.1635054 5.026095e-03 7 p__Bacteroidota 1.1976032 1.149023e-02 8 p__Bacillota_A 0.9179763 2.146291e-02 8.1.2.4 Relative abundances of Spirochaetota 8.2 Captive: before and after grass 8.2.1 Structural zeros 8.2.2 Enrichment analysis: Ancombc2 8.2.2.1 Relative abundances of archaea # A tibble: 2 × 6 diet mean_Archaea sd_Archaea max_Archaea min_Archaea zero_count &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; 1 Post_grass 0.00154 0.00292 0.00768 0 1 2 Pre_grass 0.000904 0.00228 0.00744 0 4 8.2.2.2 MAG level 8.3 wild vs post grass captive 8.3.1 Structural zeros 8.3.2 Enrichment analysis: Ancombc2 8.3.2.1 MAG level "],["functional-differences.html", "Chapter 9 Functional differences", " Chapter 9 Functional differences GIFT_db %&gt;% filter(Element==&quot;Streptogramin&quot;) Code_bundle Code_element Code_function Domain Function Element Definition 1 D090501 D0905 D09 Degradation Antibiotic degradation Streptogramin K19349,K19350 # A tibble: 15 × 6 phylum row_mean row_sd row_median row_max row_min &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 p__Bacteroidota 0.271 0.256 0.213 0.826 0 2 p__Bacillota_C 0.270 0.343 0.0833 0.944 0 3 p__Bacillota_B 0.270 0.360 0 1 0 4 p__Pseudomonadota 0.250 0.236 0.151 0.74 0 5 p__Verrucomicrobiota 0.245 0.260 0.161 0.786 0 6 p__Desulfobacterota 0.234 0.291 0.06 0.909 0 7 p__Spirochaetota 0.229 0.302 0.035 1 0 8 p__Bacillota_A 0.224 0.218 0.189 0.760 0 9 p__Cyanobacteriota 0.214 0.301 0.0357 1 0 10 p__Methanobacteriota 0.190 0.327 0 1 0 11 p__Actinomycetota 0.179 0.198 0.12 0.714 0 12 p__Synergistota 0.157 0.214 0.0373 0.8 0 13 p__Bacillota 0.0692 0.110 0.0361 0.653 0 14 p__Campylobacterota 0.0677 0.174 0 1 0 15 p__Patescibacteria 0.0336 0.0949 0 0.667 0 sugar&lt;-GIFT_db %&gt;% filter(Code_function==&quot;D03&quot;) %&gt;% select(Code_element) %&gt;% pull() GIFTs_elements_filtered %&gt;% select(any_of(sugar)) %&gt;% rowMeans() %&gt;% as.data.frame() %&gt;% rename(sugar_mean=&quot;.&quot;) %&gt;% arrange(-sugar_mean) %&gt;% rownames_to_column(&quot;genome&quot;) %&gt;% left_join(genome_metadata[,1:8], by = join_by(genome == genome)) genome sugar_mean domain phylum class order family genus 1 EHA03288_bin.1 0.6211111 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 2 EHA03303_bin.3 0.5833333 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 3 EHA04572_bin.12 0.5555556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 4 EHA03305_bin.265 0.5377778 d__Bacteria p__Bacillota c__Bacilli o__Staphylococcales f__Staphylococcaceae g__Staphylococcus 5 EHA03305_bin.41 0.5366667 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 6 EHA03303_bin.19 0.5366667 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 7 EHA03281_bin.15 0.5277778 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 8 EHA04583_bin.16 0.5277778 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 9 EHA04570_bin.15 0.5277778 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 10 EHA04577_bin.10 0.5277778 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 11 EHA03347_bin.69 0.5188889 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 12 EHA03288_bin.27 0.5100000 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 13 EHA03306_bin.47 0.5088889 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Schaedlerella 14 EHA03303_bin.10 0.5088889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 15 EHA03305_bin.54 0.5088889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 16 EHA03303_bin.18 0.5000000 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 17 EHA04571_bin.1 0.5000000 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 18 EHA03305_bin.139 0.5000000 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__CAJMNU01 19 EHA04587_bin.13 0.5000000 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 20 EHA03335_bin.59 0.5000000 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 21 EHA03288_bin.14 0.4811111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 22 EHA03306_bin.40 0.4811111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 23 EHA03335_bin.57 0.4811111 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 24 EHA03305_bin.165 0.4722222 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 25 EHA04572_bin.1 0.4722222 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 26 EHA04573_bin.2 0.4722222 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 27 EHA04588_bin.122 0.4722222 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__ 28 EHA04572_bin.27 0.4722222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 29 EHA03288_bin.16 0.4533333 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 30 EHA03305_bin.253 0.4533333 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Faecousia 31 EHA03291_bin.14 0.4444444 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 32 EHA03283_bin.10 0.4444444 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 33 EHA03290_bin.41 0.4444444 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 34 EHA03291_bin.19 0.4444444 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 35 EHA03289_bin.3 0.4444444 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 36 EHA04573_bin.17 0.4444444 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__ 37 EHA04582_bin.20 0.4444444 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 38 EHA03298_bin.3 0.4444444 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 39 EHA03288_bin.21 0.4355556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 40 EHA03288_bin.19 0.4266667 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Ventrimonas 41 EHA03291_bin.23 0.4255556 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 42 EHA03284_bin.21 0.4255556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 43 EHA03335_bin.2 0.4255556 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 44 EHA03299_bin.29 0.4255556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 45 EHA03290_bin.12 0.4255556 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 46 EHA03331_bin.42 0.4255556 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 47 EHA03294_bin.11 0.4255556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 48 EHA04588_bin.56 0.4255556 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__CALWPC01 49 EHA03335_bin.54 0.4166667 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 50 EHA04583_bin.15 0.4166667 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 51 EHA03335_bin.9 0.4166667 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 52 EHA03339_bin.8 0.4166667 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 53 EHA03292_bin.33 0.4166667 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 54 EHA03297_bin.18 0.4077778 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__Fimivicinus 55 EHA03305_bin.78 0.4066667 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__Acutalibacter 56 EHA03301_bin.14 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Marinifilaceae g__Odoribacter 57 EHA04588_bin.44 0.3977778 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__RGIG3926 58 EHA03294_bin.41 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 59 EHA03306_bin.14 0.3977778 d__Bacteria p__Bacteroidota c__Rhodothermia o__Balneolales f__Balneolaceae g__UBA2664 60 EHA03297_bin.24 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 61 EHA03339_bin.20 0.3977778 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 62 EHA04577_bin.11 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 63 EHA03284_bin.39 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 64 EHA03302_bin.23 0.3977778 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 65 EHA04584_bin.1 0.3888889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola_A 66 EHA03349_bin.61 0.3888889 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 67 EHA03331_bin.26 0.3888889 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 68 EHA04588_bin.155 0.3888889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola_A 69 EHA03302_bin.28 0.3888889 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 70 EHA03285_bin.15 0.3888889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 71 EHA04588_bin.45 0.3888889 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 72 EHA04588_bin.129 0.3888889 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Mediterranea 73 EHA03347_bin.45 0.3888889 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 74 EHA04582_bin.7 0.3888889 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 75 EHA03290_bin.23 0.3800000 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__Eubacterium_R 76 EHA04587_bin.1 0.3788889 d__Bacteria p__Spirochaetota c__Spirochaetia o__Sphaerochaetales f__Sphaerochaetaceae g__UBA9732 77 EHA03288_bin.10 0.3711111 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__14-2 78 EHA03288_bin.6 0.3700000 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__HGM12545 79 EHA03300_bin.21 0.3700000 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 80 EHA04588_bin.76 0.3700000 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 81 EHA03343_bin.35 0.3700000 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 82 EHA04572_bin.21 0.3700000 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 83 EHA03299_bin.8 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 84 EHA03281_bin.31 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 85 EHA04567_bin.10 0.3611111 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 86 EHA03286_bin.25 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 87 EHA03305_bin.111 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 88 EHA04587_bin.16 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__ 89 EHA03286_bin.19 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 90 EHA03331_bin.14 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 91 EHA04570_bin.23 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 92 EHA03281_bin.27 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 93 EHA04588_bin.163 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 94 EHA03335_bin.17 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__UBA644 g__Geddesella 95 EHA04588_bin.109 0.3611111 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 96 EHA04588_bin.141 0.3611111 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__RGIG2066 97 EHA04575_bin.6 0.3522222 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Butyricicoccaceae g__Butyricicoccus_A 98 EHA04588_bin.161 0.3522222 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__Fimenecus 99 EHA03304_bin.13 0.3522222 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 100 EHA03305_bin.282 0.3433333 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladocola 101 EHA03341_bin.11 0.3433333 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia 102 EHA03306_bin.10 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 103 EHA03329_bin.12 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 104 EHA03343_bin.5 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 105 EHA04582_bin.6 0.3422222 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__RGIG2774 106 EHA03351_bin.61 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 107 EHA03351_bin.66 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 108 EHA03306_bin.149 0.3422222 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 109 EHA03305_bin.6 0.3422222 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Butyribacter 110 EHA04569_bin.7 0.3422222 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Faecalimonas 111 EHA04575_bin.18 0.3422222 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 species 1 s__ 2 s__ 3 s__ 4 s__Staphylococcus equorum 5 s__Bacteroides caccae 6 s__Bacteroides thetaiotaomicron 7 s__ 8 s__ 9 s__ 10 s__ 11 s__ 12 s__ 13 s__ 14 s__Bacteroides uniformis 15 s__Bacteroides nordii 16 s__Phocaeicola dorei 17 s__Bacteroides eggerthii 18 s__ 19 s__Phocaeicola sartorii 20 s__Bacteroides xylanisolvens 21 s__Parabacteroides distasonis 22 s__Parabacteroides merdae 23 s__ 24 s__ 25 s__ 26 s__ 27 s__ 28 s__Phocaeicola vulgatus 29 s__Alistipes timonensis 30 s__ 31 s__ 32 s__ 33 s__ 34 s__Phocaeicola vulgatus 35 s__ 36 s__ 37 s__Bacteroides intestinalis 38 s__ 39 s__Eisenbergiella porci 40 s__ 41 s__Bacteroides uniformis 42 s__ 43 s__Parabacteroides distasonis 44 s__ 45 s__ 46 s__Bacteroides xylanisolvens 47 s__ 48 s__ 49 s__Bacteroides intestinalis 50 s__ 51 s__ 52 s__ 53 s__Alistipes senegalensis 54 s__Fimivicinus sp900544375 55 s__ 56 s__ 57 s__ 58 s__Alistipes onderdonkii 59 s__ 60 s__Parabacteroides merdae 61 s__ 62 s__Bacteroides uniformis 63 s__Bacteroides xylanisolvens 64 s__Alistipes senegalensis 65 s__Phocaeicola_A sp900765575 66 s__ 67 s__ 68 s__ 69 s__ 70 s__Bacteroides xylanisolvens 71 s__ 72 s__ 73 s__ 74 s__ 75 s__ 76 s__ 77 s__ 78 s__ 79 s__ 80 s__ 81 s__Alistipes finegoldii 82 s__ 83 s__Bacteroides uniformis 84 s__ 85 s__ 86 s__Phocaeicola vulgatus 87 s__Bacteroides cutis 88 s__ 89 s__ 90 s__Bacteroides cellulosilyticus 91 s__ 92 s__Bacteroides cellulosilyticus 93 s__Phocaeicola vulgatus 94 s__ 95 s__ 96 s__ 97 s__ 98 s__ 99 s__ 100 s__ 101 s__Blautia pullicola 102 s__ 103 s__Parabacteroides merdae 104 s__Parabacteroides distasonis 105 s__ 106 s__Bacteroides xylanisolvens 107 s__Bacteroides sp902362375 108 s__Alistipes_A ihumii 109 s__ 110 s__ 111 s__ [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 654 rows ] GIFTs_elements_filtered %&gt;% select(&quot;D0306&quot;) %&gt;% rowMeans() %&gt;% as.data.frame() %&gt;% rename(sugar_mean=&quot;.&quot;) %&gt;% arrange(-sugar_mean) %&gt;% rownames_to_column(&quot;genome&quot;) %&gt;% left_join(genome_metadata[,1:8], by = join_by(genome == genome)) genome sugar_mean domain phylum class order family genus 1 EHA03349_bin.48 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 2 EHA04588_bin.64 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 3 EHA03295_bin.26 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 4 EHA03288_bin.6 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__HGM12545 5 EHA03303_bin.3 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 6 EHA03281_bin.15 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 7 EHA03305_bin.165 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 8 EHA03305_bin.265 1.0 d__Bacteria p__Bacillota c__Bacilli o__Staphylococcales f__Staphylococcaceae g__Staphylococcus 9 EHA03305_bin.111 1.0 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 10 EHA03343_bin.52 1.0 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 11 EHA03291_bin.14 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 12 EHA03306_bin.118 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-917 g__Limadaptatus 13 EHA03341_bin.28 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Coproplasma 14 EHA03295_bin.13 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus 15 EHA04588_bin.76 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 16 EHA04588_bin.153 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 17 EHA03302_bin.28 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 18 EHA03306_bin.220 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 19 EHA03305_bin.38 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__CAG-272 g__Avispirillum 20 EHA03306_bin.145 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus 21 EHA03292_bin.9 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 22 EHA03288_bin.8 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA2882 23 EHA03305_bin.282 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladocola 24 EHA03303_bin.19 1.0 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 25 EHA03339_bin.20 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_D 26 EHA03339_bin.8 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 27 EHA03306_bin.47 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Schaedlerella 28 EHA03285_bin.7 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__UBA7477 29 EHA04583_bin.10 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Peptostreptococcales f__Anaerovoracaceae g__UMGS973 30 EHA03282_bin.22 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__UBA7477 31 EHA04577_bin.1 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 32 EHA03329_bin.39 1.0 d__Bacteria p__Bacillota c__Bacilli o__Staphylococcales f__Salinicoccaceae g__Jeotgalicoccus 33 EHA03305_bin.19 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__ 34 EHA03296_bin.26 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 35 EHA03305_bin.104 1.0 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminococcus_C 36 EHA03298_bin.3 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 37 EHA03347_bin.45 1.0 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 38 EHA04588_bin.120 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Pelethomonas 39 EHA03298_bin.15 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 40 EHA03305_bin.41 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 41 EHA03306_bin.10 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 42 EHA03290_bin.49 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 43 EHA03294_bin.16 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Marvinbryantia 44 EHA03305_bin.75 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Muribaculaceae g__CAG-485 45 EHA04584_bin.1 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola_A 46 EHA04583_bin.6 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Gemmiger 47 EHA03289_bin.28 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 48 EHA03286_bin.16 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 49 EHA03282_bin.26 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 50 EHA04588_bin.67 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 51 EHA03329_bin.12 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 52 EHA03306_bin.164 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3282 53 EHA04588_bin.54 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Peptostreptococcales f__Anaerovoracaceae g__UMGS973 54 EHA03290_bin.8 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 55 EHA04583_bin.22 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Merdiplasma 56 EHA03347_bin.44 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eubacterium_F 57 EHA03300_bin.16 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Muribaculaceae g__Muribaculum 58 EHA04588_bin.44 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__RGIG3926 59 EHA03345_bin.7 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 60 EHA03306_bin.165 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Muribaculaceae g__Duncaniella 61 EHA03337_bin.9 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Gallimonas 62 EHA04571_bin.13 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__UBA1224 63 EHA04582_bin.24 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__ 64 EHA04584_bin.13 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__ 65 EHA04577_bin.6 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__V9D3004 66 EHA04588_bin.88 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 67 EHA04575_bin.22 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 68 EHA03303_bin.13 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__UBA11524 69 EHA03299_bin.8 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 70 EHA04588_bin.100 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Paraprevotella 71 EHA03292_bin.24 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 72 EHA03305_bin.61 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 73 EHA03351_bin.10 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruminiclostridium_E 74 EHA03331_bin.46 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__ 75 EHA04567_bin.6 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 76 EHA04588_bin.127 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Lawsonibacter 77 EHA03335_bin.4 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 78 EHA03281_bin.31 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 79 EHA04588_bin.59 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Anaerotignaceae g__Metalachnospira 80 EHA04567_bin.10 0.5 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 81 EHA04584_bin.3 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Merdiplasma 82 EHA03291_bin.16 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 83 EHA03349_bin.14 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 84 EHA03290_bin.3 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__CAG-272 g__CAG-272 85 EHA03305_bin.136 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Enterenecus 86 EHA03288_bin.29 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladocola 87 EHA03351_bin.13 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Muribaculaceae g__CAG-485 88 EHA03345_bin.19 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__ 89 EHA03286_bin.25 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 90 EHA03289_bin.10 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__ 91 EHA03347_bin.69 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 92 EHA04588_bin.58 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 93 EHA04588_bin.9 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 94 EHA03351_bin.36 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Lawsonibacter 95 EHA03305_bin.129 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 96 EHA04569_bin.16 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 97 EHA03343_bin.5 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 98 EHA03333_bin.32 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__CAG-274 g__CALWRD01 99 EHA03349_bin.61 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 100 EHA03288_bin.14 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 101 EHA03305_bin.278 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__UMGS1601 102 EHA04583_bin.16 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 103 EHA03300_bin.21 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 104 EHA03331_bin.36 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladocola 105 EHA04588_bin.69 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 106 EHA03347_bin.26 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 107 EHA03288_bin.21 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 108 EHA03333_bin.57 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Marvinbryantia 109 EHA04588_bin.90 0.5 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Marinifilaceae g__Odoribacter 110 EHA03347_bin.78 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 111 EHA03345_bin.25 0.5 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__SFTH01 species 1 s__ 2 s__ 3 s__ 4 s__ 5 s__ 6 s__ 7 s__ 8 s__Staphylococcus equorum 9 s__Bacteroides cutis 10 s__Parabacteroides goldsteinii 11 s__ 12 s__ 13 s__ 14 s__Ruminococcus sp017462565 15 s__ 16 s__ 17 s__ 18 s__ 19 s__ 20 s__Ruminococcus sp900752785 21 s__ 22 s__UBA2882 sp002362385 23 s__ 24 s__Bacteroides thetaiotaomicron 25 s__ 26 s__ 27 s__ 28 s__ 29 s__ 30 s__ 31 s__ 32 s__ 33 s__ 34 s__ 35 s__ 36 s__ 37 s__ 38 s__ 39 s__ 40 s__Bacteroides caccae 41 s__ 42 s__ 43 s__ 44 s__ 45 s__Phocaeicola_A sp900765575 46 s__ 47 s__Bacteroides intestinalis 48 s__ 49 s__Phocaeicola dorei 50 s__ 51 s__Parabacteroides merdae 52 s__ 53 s__ 54 s__ 55 s__ 56 s__ 57 s__Muribaculum gordoncarteri 58 s__ 59 s__ 60 s__ 61 s__ 62 s__ 63 s__ 64 s__ 65 s__ 66 s__ 67 s__Bacteroides thetaiotaomicron 68 s__ 69 s__Bacteroides uniformis 70 s__ 71 s__ 72 s__ 73 s__ 74 s__ 75 s__ 76 s__ 77 s__ 78 s__ 79 s__ 80 s__ 81 s__ 82 s__ 83 s__Alistipes_A ihumii 84 s__ 85 s__ 86 s__ 87 s__CAG-485 sp002493515 88 s__ 89 s__Phocaeicola vulgatus 90 s__ 91 s__ 92 s__Alistipes dispar 93 s__ 94 s__ 95 s__ 96 s__ 97 s__Parabacteroides distasonis 98 s__ 99 s__ 100 s__Parabacteroides distasonis 101 s__ 102 s__ 103 s__ 104 s__ 105 s__ 106 s__ 107 s__Eisenbergiella porci 108 s__ 109 s__Odoribacter splanchnicus 110 s__ 111 s__ [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 654 rows ] GIFTs_elements_filtered %&gt;% select(&quot;D0307&quot;) %&gt;% rowMeans() %&gt;% as.data.frame() %&gt;% rename(sugar_mean=&quot;.&quot;) %&gt;% arrange(-sugar_mean) %&gt;% rownames_to_column(&quot;genome&quot;) %&gt;% left_join(genome_metadata[,1:8], by = join_by(genome == genome)) genome sugar_mean domain phylum class order family 1 EHA04588_bin.77 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 2 EHA03303_bin.3 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 3 EHA04582_bin.24 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 4 EHA04575_bin.14 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 5 EHA03347_bin.69 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 6 EHA03305_bin.129 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 7 EHA04583_bin.16 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 8 EHA04570_bin.7 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 9 EHA03288_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 10 EHA03283_bin.10 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 11 EHA04570_bin.15 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 12 EHA04582_bin.6 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 13 EHA03297_bin.18 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 14 EHA04588_bin.76 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 15 EHA03285_bin.11 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 16 EHA03288_bin.27 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 17 EHA04588_bin.138 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 18 EHA03302_bin.28 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 19 EHA04588_bin.193 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 20 EHA04573_bin.17 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 21 EHA03288_bin.1 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 22 EHA04588_bin.189 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__UBA1750 23 EHA03286_bin.3 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 24 EHA03305_bin.6 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 25 EHA04588_bin.161 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 26 EHA03339_bin.20 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 27 EHA04572_bin.12 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 28 EHA03290_bin.23 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 29 EHA03302_bin.12 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 30 EHA04588_bin.56 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 31 EHA04577_bin.10 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 32 EHA04588_bin.141 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 33 EHA04584_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 34 EHA03305_bin.187 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 35 EHA03287_bin.24 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 36 EHA04571_bin.13 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 37 EHA03281_bin.15 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 38 EHA03305_bin.165 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 39 EHA04587_bin.15 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 40 EHA03349_bin.61 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 41 EHA03294_bin.29 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 42 EHA03306_bin.99 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 43 EHA03305_bin.278 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 44 EHA03299_bin.17 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 45 EHA04572_bin.1 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 46 EHA03331_bin.26 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 47 EHA04573_bin.2 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 48 EHA03302_bin.33 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__CAG-272 49 EHA03335_bin.57 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 50 EHA03306_bin.104 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Pumilibacteraceae 51 EHA04583_bin.15 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 52 EHA03289_bin.3 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 53 EHA03295_bin.18 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 54 EHA03290_bin.56 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 55 EHA03305_bin.139 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 56 EHA03335_bin.17 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__UBA644 57 EHA03331_bin.3 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 58 EHA03304_bin.13 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 59 EHA03347_bin.45 0.50 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 60 EHA03305_bin.253 0.50 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 61 EHA03301_bin.14 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Marinifilaceae 62 EHA03305_bin.41 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 63 EHA04587_bin.6 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 64 EHA03296_bin.13 0.25 d__Bacteria p__Cyanobacteriota c__Vampirovibrionia o__Gastranaerophilales f__Gastranaerophilaceae 65 EHA04588_bin.65 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Peptostreptococcales f__Anaerovoracaceae 66 EHA04584_bin.1 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 67 EHA03282_bin.26 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 68 EHA03306_bin.164 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 69 EHA04588_bin.152 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Peptostreptococcales f__Anaerovoracaceae 70 EHA03305_bin.10 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 71 EHA04584_bin.27 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 72 EHA03290_bin.14 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 73 EHA04588_bin.44 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 74 EHA03288_bin.6 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 75 EHA03306_bin.165 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Muribaculaceae 76 EHA03303_bin.13 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 77 EHA03299_bin.8 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 78 EHA03351_bin.10 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 79 EHA04567_bin.6 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 80 EHA03335_bin.4 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae 81 EHA03281_bin.31 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 82 EHA04588_bin.59 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Anaerotignaceae 83 EHA04567_bin.10 0.25 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 84 EHA03295_bin.24 0.25 d__Bacteria p__Pseudomonadota c__Gammaproteobacteria o__Burkholderiales f__Burkholderiaceae_A 85 EHA03291_bin.16 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 86 EHA03349_bin.14 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae 87 EHA03288_bin.29 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 88 EHA03286_bin.25 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 89 EHA03289_bin.10 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 90 EHA03306_bin.103 0.25 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__UBA1829 91 EHA03305_bin.7 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae 92 EHA03341_bin.13 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae 93 EHA04588_bin.158 0.25 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__UBA1829 94 EHA03329_bin.77 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 95 EHA03300_bin.21 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 96 EHA03291_bin.14 0.25 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 97 EHA03295_bin.10 0.25 d__Bacteria p__Bacillota_C c__Negativicutes o__Acidaminococcales f__Acidaminococcaceae 98 EHA04588_bin.80 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Peptostreptococcales f__Anaerovoracaceae 99 EHA03347_bin.26 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae 100 EHA03349_bin.18 0.25 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae 101 EHA03345_bin.25 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 102 EHA03286_bin.23 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 103 EHA03306_bin.118 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-917 104 EHA04587_bin.16 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 105 EHA04583_bin.1 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 106 EHA03290_bin.41 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae 107 EHA03306_bin.152 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae 108 EHA03306_bin.14 0.25 d__Bacteria p__Bacteroidota c__Rhodothermia o__Balneolales f__Balneolaceae 109 EHA04577_bin.13 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 110 EHA03351_bin.61 0.25 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae 111 EHA03343_bin.8 0.25 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae genus species 1 g__RGIG3926 s__ 2 g__Choladousia s__ 3 g__ s__ 4 g__Enterocloster s__Enterocloster clostridioformis 5 g__Eisenbergiella s__ 6 g__Choladousia s__ 7 g__Choladousia s__ 8 g__ s__ 9 g__Eisenbergiella s__Eisenbergiella porci 10 g__Blautia_A s__ 11 g__Blautia_A s__ 12 g__RGIG2774 s__ 13 g__Fimivicinus s__Fimivicinus sp900544375 14 g__Ruminococcus_D s__ 15 g__ s__ 16 g__Blautia_A s__ 17 g__UMGS1601 s__ 18 g__Ruminococcus_D s__ 19 g__RGIG2066 s__ 20 g__ s__ 21 g__Eisenbergiella s__ 22 g__UBA1428 s__ 23 g__Eubacterium_R s__ 24 g__Butyribacter s__ 25 g__Fimenecus s__ 26 g__Ruminococcus_D s__ 27 g__Eisenbergiella s__ 28 g__Eubacterium_R s__ 29 g__UMGS1601 s__ 30 g__CALWPC01 s__ 31 g__Choladousia s__ 32 g__RGIG2066 s__ 33 g__ s__ 34 g__Acetatifactor s__ 35 g__CAJOIG01 s__ 36 g__UBA1224 s__ 37 g__Victivallis s__ 38 g__Victivallis s__ 39 g__UBA1224 s__ 40 g__CAJOIG01 s__ 41 g__Acetatifactor s__ 42 g__Acetatifactor s__ 43 g__UMGS1601 s__ 44 g__ s__ 45 g__Victivallis s__ 46 g__Victivallis s__ 47 g__Victivallis s__ 48 g__RUG11130 s__ 49 g__CAJOIG01 s__ 50 g__CAG-552 s__ 51 g__Blautia_A s__ 52 g__Victivallis s__ 53 g__UMGS1601 s__ 54 g__Acetatifactor s__ 55 g__CAJMNU01 s__ 56 g__Geddesella s__ 57 g__UMGS1601 s__ 58 g__Victivallis s__ 59 g__Victivallis s__ 60 g__Faecousia s__ 61 g__Odoribacter s__ 62 g__Bacteroides s__Bacteroides caccae 63 g__MGBC124762 s__ 64 g__Zag111 s__ 65 g__Alangreenwoodia s__ 66 g__Phocaeicola_A s__Phocaeicola_A sp900765575 67 g__Phocaeicola s__Phocaeicola dorei 68 g__UBA3282 s__ 69 g__Emergencia s__ 70 g__Bacteroides s__Bacteroides cellulosilyticus 71 g__Bacteroides s__ 72 g__Fimenecus s__ 73 g__RGIG3926 s__ 74 g__HGM12545 s__ 75 g__Duncaniella s__ 76 g__UBA11524 s__ 77 g__Bacteroides s__Bacteroides uniformis 78 g__Ruminiclostridium_E s__ 79 g__CAJOIG01 s__ 80 g__Alistipes_A s__ 81 g__UBA3402 s__ 82 g__Metalachnospira s__ 83 g__Victivallis s__ 84 g__Parasutterella s__ 85 g__Eisenbergiella s__ 86 g__Alistipes_A s__Alistipes_A ihumii 87 g__Choladocola s__ 88 g__Phocaeicola s__Phocaeicola vulgatus 89 g__ s__ 90 g__UBA11452 s__UBA11452 sp003526375 91 g__Alistipes_A s__Alistipes_A pullistercoris 92 g__Gemmiger s__ 93 g__UBA11452 s__UBA11452 sp003526375 94 g__Pelethomonas s__ 95 g__Eisenbergiella s__ 96 g__Victivallis s__ 97 g__CAG-266 s__CAG-266 sp000436095 98 g__QAKD01 s__ 99 g__RUG626 s__ 100 g__Victivallis s__ 101 g__SFTH01 s__ 102 g__ s__ 103 g__Limadaptatus s__ 104 g__ s__ 105 g__Ventrimonas s__ 106 g__UBA3402 s__ 107 g__Eubacterium_R s__ 108 g__UBA2664 s__ 109 g__SFTH01 s__ 110 g__Bacteroides s__Bacteroides xylanisolvens 111 g__ s__ [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 654 rows ] GIFTs_elements_filtered %&gt;% select(&quot;D0308&quot;) %&gt;% rowMeans() %&gt;% as.data.frame() %&gt;% rename(sugar_mean=&quot;.&quot;) %&gt;% arrange(-sugar_mean) %&gt;% rownames_to_column(&quot;genome&quot;) %&gt;% left_join(genome_metadata[,1:8], by = join_by(genome == genome)) genome sugar_mean domain phylum class order family genus 1 EHA03298_bin.15 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 2 EHA03305_bin.41 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 3 EHA03306_bin.10 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 4 EHA04584_bin.1 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola_A 5 EHA04588_bin.67 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 6 EHA03303_bin.3 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 7 EHA03303_bin.13 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__UBA11524 8 EHA03305_bin.265 1.00 d__Bacteria p__Bacillota c__Bacilli o__Staphylococcales f__Staphylococcaceae g__Staphylococcus 9 EHA03347_bin.69 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 10 EHA03305_bin.7 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 11 EHA03284_bin.37 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 12 EHA03294_bin.41 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 13 EHA03288_bin.14 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 14 EHA03306_bin.40 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 15 EHA03351_bin.61 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 16 EHA03291_bin.19 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 17 EHA04572_bin.27 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 18 EHA04588_bin.155 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola_A 19 EHA03286_bin.19 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 20 EHA03343_bin.6 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 21 EHA03335_bin.54 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 22 EHA03288_bin.1 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 23 EHA03303_bin.18 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 24 EHA03331_bin.14 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 25 EHA04571_bin.1 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 26 EHA03282_bin.3 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 27 EHA03303_bin.19 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 28 EHA03292_bin.33 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 29 EHA03289_bin.1 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 30 EHA03305_bin.139 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__CAJMNU01 31 EHA03284_bin.21 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 32 EHA03335_bin.2 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 33 EHA03299_bin.29 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 34 EHA04587_bin.13 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 35 EHA04572_bin.12 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 36 EHA03281_bin.27 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 37 EHA04588_bin.163 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 38 EHA04588_bin.109 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 39 EHA03335_bin.59 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 40 EHA03331_bin.42 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 41 EHA03302_bin.23 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 42 EHA03294_bin.11 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 43 EHA04582_bin.20 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 44 EHA04588_bin.129 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Mediterranea 45 EHA03305_bin.54 1.00 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 46 EHA03305_bin.187 1.00 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Acetatifactor 47 EHA04570_bin.11 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA11774 48 EHA03329_bin.12 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Tannerellaceae g__Parabacteroides 49 EHA03290_bin.8 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 50 EHA03282_bin.24 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Phocaeicola 51 EHA03347_bin.46 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Gallimonas 52 EHA03305_bin.10 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 53 EHA04584_bin.27 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 54 EHA03288_bin.6 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__HGM12545 55 EHA04588_bin.27 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__UBA738 56 EHA03305_bin.165 0.75 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 57 EHA03299_bin.8 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 58 EHA03292_bin.24 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 59 EHA03335_bin.4 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 60 EHA03347_bin.49 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Gallimonas 61 EHA03335_bin.23 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__UMGS1883 f__UMGS1883 g__JAJQCX01 62 EHA03287_bin.10 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__UMGS1883 f__UMGS1883 g__JAJQCX01 63 EHA03306_bin.65 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__CAG-272 g__CAKSQF01 64 EHA04587_bin.4 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Enterenecus 65 EHA04588_bin.9 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 66 EHA03304_bin.14 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__UMGS1883 f__UMGS1883 g__JAJQCX01 67 EHA04569_bin.16 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 68 EHA03341_bin.13 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Gemmiger 69 EHA03306_bin.99 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Acetatifactor 70 EHA04583_bin.16 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Choladousia 71 EHA03300_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 72 EHA03347_bin.26 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 73 EHA03288_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Eisenbergiella 74 EHA03305_bin.48 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 75 EHA03347_bin.78 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 76 EHA03306_bin.194 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Flavobacteriales f__UBA1820 g__Merdimorpha 77 EHA03294_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__Ventricola 78 EHA04570_bin.15 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 79 EHA04587_bin.16 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__CAG-74 g__ 80 EHA03290_bin.41 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 81 EHA03306_bin.93 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__JAAYOS01 g__CALXFK01 82 EHA03335_bin.29 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__JAAYOS01 g__CALXFK01 83 EHA04588_bin.75 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 84 EHA03290_bin.25 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Gallimonas 85 EHA03284_bin.22 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 86 EHA03335_bin.57 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 87 EHA03293_bin.10 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 88 EHA03305_bin.55 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Ruminococcaceae g__Ruthenibacterium 89 EHA03285_bin.15 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 90 EHA03351_bin.66 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 91 EHA03306_bin.220 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__RUG626 92 EHA03302_bin.22 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 93 EHA03306_bin.149 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes_A 94 EHA04583_bin.15 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Blautia_A 95 EHA03289_bin.3 0.75 d__Bacteria p__Verrucomicrobiota c__Lentisphaeria o__Victivallales f__Victivallaceae g__Victivallis 96 EHA04575_bin.9 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 97 EHA03288_bin.16 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 98 EHA03294_bin.9 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Christensenellales f__Borkfalkiaceae g__Coproplasma 99 EHA03286_bin.18 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__UBA3402 100 EHA03290_bin.56 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__Acetatifactor 101 EHA04582_bin.3 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Lachnospirales f__Lachnospiraceae g__COE1 102 EHA04577_bin.11 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Bacteroidaceae g__Bacteroides 103 EHA03305_bin.134 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 104 EHA03305_bin.78 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__Acutalibacter 105 EHA04587_bin.1 0.75 d__Bacteria p__Spirochaetota c__Spirochaetia o__Sphaerochaetales f__Sphaerochaetaceae g__UBA9732 106 EHA03305_bin.89 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__CAG-272 g__CAKSQF01 107 EHA03290_bin.12 0.75 d__Bacteria p__Bacteroidota c__Bacteroidia o__Bacteroidales f__Rikenellaceae g__Alistipes 108 EHA03305_bin.14 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__Pelethomonas 109 EHA04575_bin.18 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 110 EHA04572_bin.9 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Acutalibacteraceae g__UBA6857 111 EHA04572_bin.21 0.75 d__Bacteria p__Bacillota_A c__Clostridia o__Oscillospirales f__Oscillospiraceae g__CAJOIG01 species 1 s__ 2 s__Bacteroides caccae 3 s__ 4 s__Phocaeicola_A sp900765575 5 s__ 6 s__ 7 s__ 8 s__Staphylococcus equorum 9 s__ 10 s__Alistipes_A pullistercoris 11 s__Bacteroides xylanisolvens 12 s__Alistipes onderdonkii 13 s__Parabacteroides distasonis 14 s__Parabacteroides merdae 15 s__Bacteroides xylanisolvens 16 s__Phocaeicola vulgatus 17 s__Phocaeicola vulgatus 18 s__ 19 s__ 20 s__ 21 s__Bacteroides intestinalis 22 s__ 23 s__Phocaeicola dorei 24 s__Bacteroides cellulosilyticus 25 s__Bacteroides eggerthii 26 s__ 27 s__Bacteroides thetaiotaomicron 28 s__Alistipes senegalensis 29 s__ 30 s__ 31 s__ 32 s__Parabacteroides distasonis 33 s__ 34 s__Phocaeicola sartorii 35 s__ 36 s__Bacteroides cellulosilyticus 37 s__Phocaeicola vulgatus 38 s__ 39 s__Bacteroides xylanisolvens 40 s__Bacteroides xylanisolvens 41 s__Alistipes senegalensis 42 s__ 43 s__Bacteroides intestinalis 44 s__ 45 s__Bacteroides nordii 46 s__ 47 s__ 48 s__Parabacteroides merdae 49 s__ 50 s__Phocaeicola dorei 51 s__ 52 s__Bacteroides cellulosilyticus 53 s__ 54 s__ 55 s__ 56 s__ 57 s__Bacteroides uniformis 58 s__ 59 s__ 60 s__ 61 s__ 62 s__ 63 s__ 64 s__ 65 s__ 66 s__ 67 s__ 68 s__ 69 s__ 70 s__ 71 s__ 72 s__ 73 s__Eisenbergiella porci 74 s__ 75 s__ 76 s__Merdimorpha sp003150615 77 s__ 78 s__ 79 s__ 80 s__ 81 s__ 82 s__ 83 s__ 84 s__ 85 s__ 86 s__ 87 s__ 88 s__Ruthenibacterium lactatiformans 89 s__Bacteroides xylanisolvens 90 s__Bacteroides sp902362375 91 s__ 92 s__ 93 s__Alistipes_A ihumii 94 s__ 95 s__ 96 s__ 97 s__Alistipes timonensis 98 s__ 99 s__ 100 s__ 101 s__ 102 s__Bacteroides uniformis 103 s__Alistipes communis 104 s__ 105 s__ 106 s__ 107 s__ 108 s__ 109 s__ 110 s__ 111 s__ [ reached &#39;max&#39; / getOption(&quot;max.print&quot;) -- omitted 654 rows ] # A tibble: 15 × 21 # Groups: phylum [15] phylum Nucleic acid biosynt…¹ Amino acid biosynthe…² Amino acid derivativ…³ `SCFA biosynthesis` Organic anion biosyn…⁴ `Vitamin biosynthesis` &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; 1 p__Actinomycetota 0.568 0.431 0 0.39 0.286 0.101 2 p__Bacillota 0.213 0.0525 0.0343 0.373 0.0588 0.0328 3 p__Bacillota_A 0.577 0.502 0.110 0.496 0.260 0.179 4 p__Bacillota_B 0.762 0.818 0.2 0.67 0.525 0.29 5 p__Bacillota_C 0.883 0.657 0.428 0.407 0.466 0.363 6 p__Bacteroidota 0.669 0.457 0.0913 0.452 0.576 0.484 7 p__Campylobactero… 0.315 0 0 0.33 0.27 0 8 p__Cyanobacteriota 0.696 0.326 0.171 0.226 0.221 0.123 9 p__Desulfobactero… 0.780 0.612 0.182 0.584 0.485 0.305 10 p__Methanobacteri… 0.94 0.67 0.1 0.29 0.68 0.155 11 p__Patescibacteria 0.146 0 0.00833 0.165 0.005 0 12 p__Pseudomonadota 0.604 0.569 0.186 0.477 0.561 0.344 13 p__Spirochaetota 0.812 0.438 0 0.33 0.5 0.14 14 p__Synergistota 0.45 0.37 0.0333 0.381 0.135 0.159 15 p__Verrucomicrobi… 0.589 0.424 0.0714 0.435 0.492 0.243 # ℹ abbreviated names: ¹​`Nucleic acid biosynthesis`, ²​`Amino acid biosynthesis`, ³​`Amino acid derivative biosynthesis`, ⁴​`Organic anion biosynthesis` # ℹ 14 more variables: `Aromatic compound biosynthesis` &lt;dbl&gt;, `Metallophore biosynthesis` &lt;dbl&gt;, `Antibiotic biosynthesis` &lt;dbl&gt;, # `Lipid degradation` &lt;dbl&gt;, `Polysaccharide degradation` &lt;dbl&gt;, `Sugar degradation` &lt;dbl&gt;, `Amino acid degradation` &lt;dbl&gt;, # `Nitrogen compound degradation` &lt;dbl&gt;, `Alcohol degradation` &lt;dbl&gt;, `Xenobiotic degradation` &lt;dbl&gt;, `Antibiotic degradation` &lt;dbl&gt;, # `Cellular structure` &lt;dbl&gt;, Appendages &lt;dbl&gt;, Spore &lt;dbl&gt; "],["spirochaetota.html", "Chapter 10 Spirochaetota 10.1 MCI 10.2 Community level plots 10.3 ANCOM-BC2 10.4 Wilcoxon comparison", " Chapter 10 Spirochaetota 10.1 MCI GIFTs_functions_community %&gt;% rowMeans() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) %&gt;% # filter(time_point==&quot;0_Wild&quot;) %&gt;% group_by(diet) %&gt;% summarise(MCI = mean(value), sd = sd(value)) %&gt;% tt() .table td.tinytable_css_idhqh78wqi9om5azfl0mef, .table th.tinytable_css_idhqh78wqi9om5azfl0mef { border-bottom: solid 0.1em #d3d8dc; } diet MCI sd Post_grass 0.2396430 0.01304278 Pre_grass 0.2493529 0.01524032 Wild 0.2541861 0.02059163 MCI &lt;- GIFTs_functions_community %&gt;% rowMeans() %&gt;% as_tibble(., rownames = &quot;sample&quot;) %&gt;% left_join(sample_metadata, by = join_by(sample == sample)) # %&gt;% # filter(diet!=&quot;Post_grass&quot;) shapiro.test(MCI$value) Shapiro-Wilk normality test data: MCI$value W = 0.98397, p-value = 0.8693 res.aov &lt;- aov(value ~ diet, data=MCI) summary(res.aov) Df Sum Sq Mean Sq F value Pr(&gt;F) diet 2 0.001317 0.0006583 2.39 0.107 Residuals 33 0.009090 0.0002755 10.2 Community level plots 10.3 ANCOM-BC2 10.3.1 Captive vs Wild 10.3.1.1 Element level 10.4 Wilcoxon comparison 10.4.1 Community elements differences: difference_table %&gt;% filter(group_color==&quot;Wild&quot;) %&gt;% tt() .table td.tinytable_css_idsaf4uxn29jtnixwpp92l, .table th.tinytable_css_idsaf4uxn29jtnixwpp92l { border-bottom: solid 0.1em #d3d8dc; } Elements Pre_grass Wild Function Element Difference group_color D0702 2.176967e-01 4.215706e-01 Alcohol degradation_Ethanol Ethanol -0.2038739000 Wild D0708 6.562387e-02 1.137517e-01 Alcohol degradation_Phytol Phytol -0.0481278300 Wild D0705 2.174659e-01 2.932360e-01 Alcohol degradation_Propylene glycol Propylene glycol -0.0757701000 Wild D0509 3.498560e-01 4.690221e-01 Amino acid degradation_Arginine Arginine -0.1191661000 Wild D0505 2.884142e-01 3.728710e-01 Amino acid degradation_Valine Valine -0.0844568000 Wild B0307 2.568247e-01 3.888024e-01 Amino acid derivative biosynthesis_Spermidine Spermidine -0.1319777000 Wild D0903 1.047526e-03 2.363183e-03 Antibiotic degradation_Cephalosporin Cephalosporin -0.0013156570 Wild D0904 3.904555e-05 1.422616e-03 Antibiotic degradation_Oxacillin Oxacillin -0.0013835705 Wild B0902 9.761388e-06 3.556539e-04 Metallophore biosynthesis_Aerobactin Aerobactin -0.0003458925 Wild D0608 3.360954e-04 1.404321e-02 Nitrogen compound degradation_Betaine Betaine -0.0137071121 Wild D0306 2.292213e-01 3.300262e-01 Sugar degradation_D-Xylose D-Xylose -0.1008049000 Wild D0806 2.616052e-05 9.531525e-04 Xenobiotic degradation_Anthranilate Anthranilate -0.0009269920 Wild D0811 3.527381e-06 1.281851e-04 Xenobiotic degradation_Benzoyl-CoA Benzoyl-CoA -0.0001246577 Wild D0808 1.952277e-06 7.113078e-05 Xenobiotic degradation_Cumate Cumate -0.0000691785 Wild D0819 4.314553e-05 1.892106e-03 Xenobiotic degradation_Mercury Mercury -0.0018489605 Wild 10.4.1.1 Functional level 10.4.2 Before and after grass 10.4.2.1 Element level 10.4.2.2 Functional level taxon lfc_dietPre_grass p_dietPre_grass Domain Function 1 S03 -0.1948368 0.01689626 Structure Spore "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
